CODE:00000000 ;
CODE:00000000 ; +-------------------------------------------------------------------------+
CODE:00000000 ; |      This file was generated by The Interactive Disassembler (IDA)      |
CODE:00000000 ; |           Copyright (c) 2019 Hex-Rays, <support@hex-rays.com>           |
CODE:00000000 ; |                      License info: 48-BABB-7E64-E2                      |
CODE:00000000 ; |                     Georgia Institute of Technology                     |
CODE:00000000 ; +-------------------------------------------------------------------------+
CODE:00000000 ;
CODE:00000000 ; Input SHA256 : 9F4782D53AB711C010F3823255CEBC9314A29D578BD57D4E5F6EB1535D5D0F20
CODE:00000000 ; Input MD5    : C06DB2FB5822AD94FF9B8D9BFB5FEB74
CODE:00000000 ; Input CRC32  : E57B6E71
CODE:00000000
CODE:00000000 ; ---------------------------------------------------------------------------
CODE:00000000 ; File Name   : /nethome/hmiyaziwala3/4894/Start_to_VMCheck2.txt
CODE:00000000 ; Format      : Dump file
CODE:00000000
CODE:00000000                 .686p
CODE:00000000                 .mmx
CODE:00000000                 .model flat
CODE:00000000
CODE:00000000 ; ===========================================================================
CODE:00000000
CODE:00000000 ; Segment type: Pure code
CODE:00000000 CODE            segment byte public 'CODE' use32
CODE:00000000                 assume cs:CODE
CODE:00000000                 assume es:nothing, ss:nothing, ds:CODE, fs:nothing, gs:nothing
CODE:00000000                 mov     eax, [esp]
CODE:00000003                 push    eax
CODE:00000004                 push    large dword ptr fs:0
CODE:0000000B                 mov     large fs:0, esp
CODE:00000012                 xor     eax, eax
CODE:00000014                 mov     eax, [eax]
CODE:00000016                 retn
CODE:00000017 ; ---------------------------------------------------------------------------
CODE:00000017                 mov     eax, [esp+0Ch]
CODE:0000001B                 mov     esp, [eax+0C4h]
CODE:00000021                 pop     large dword ptr fs:0
CODE:00000028                 pop     edx
CODE:00000029                 pop     ebp
CODE:0000002A                 sub     ebp, 401011h
CODE:00000030                 add     ebp, 2
CODE:00000033                 cmp     ebp, 0
CODE:00000036                 jz      short loc_61
CODE:00000038                 mov     esi, 401072h
CODE:0000003D                 add     esi, ebp
CODE:0000003F                 mov     ecx, 1720h
CODE:00000044                 sub     ecx, 72h ; 'r'
CODE:0000004A
CODE:0000004A loc_4A:                                 ; CODE XREF: CODE:0000005F↓j
CODE:0000004A                 push    ecx
CODE:0000004B                 mov     cx, [esi]
CODE:0000004E                 ror     ch, cl
CODE:00000050                 xchg    ch, cl
CODE:00000052                 mov     [esi], cx
CODE:00000055                 add     esi, 2
CODE:00000058                 pop     ecx
CODE:00000059                 sub     ecx, 2
CODE:0000005C                 cmp     ecx, 0
CODE:0000005F                 ja      short loc_4A
CODE:00000061
CODE:00000061 loc_61:                                 ; CODE XREF: CODE:00000036↑j
CODE:00000061                 jmp     near ptr loc_265+1
CODE:00000066 ; ---------------------------------------------------------------------------
CODE:00000066                 call    near ptr 54B7h   ; NOTICE NEW CODE STARTS HERE
CODE:0000006B                 jmp     near ptr 0FFFFFEB0h
CODE:00000070 ; ---------------------------------------------------------------------------
CODE:00000070                 sub     eax, 3A4h
CODE:00000075                 jz      short loc_99
CODE:00000077                 sub     eax, 4
CODE:0000007A                 jz      short loc_93
CODE:0000007C                 sub     eax, 0Dh
CODE:0000007F                 jz      short loc_8D
CODE:00000081                 dec     eax
CODE:00000082                 jz      short loc_87
CODE:00000084                 xor     eax, eax
CODE:00000086                 retn
CODE:00000087 ; ---------------------------------------------------------------------------
CODE:00000087
CODE:00000087 loc_87:                                 ; CODE XREF: CODE:00000082↑j
CODE:00000087                 mov     eax, 404h
CODE:0000008C                 retn
CODE:0000008D ; ---------------------------------------------------------------------------
CODE:0000008D
CODE:0000008D loc_8D:                                 ; CODE XREF: CODE:0000007F↑j
CODE:0000008D                 mov     eax, 412h
CODE:00000092                 retn
CODE:00000093 ; ---------------------------------------------------------------------------
CODE:00000093
CODE:00000093 loc_93:                                 ; CODE XREF: CODE:0000007A↑j
CODE:00000093                 mov     eax, 804h
CODE:00000098                 retn
CODE:00000099 ; ---------------------------------------------------------------------------
CODE:00000099
CODE:00000099 loc_99:                                 ; CODE XREF: CODE:00000075↑j
CODE:00000099                 mov     eax, 411h
CODE:0000009E                 retn
CODE:0000009F ; ---------------------------------------------------------------------------
CODE:0000009F                 push    ebx
CODE:000000A0                 push    ebp
CODE:000000A1                 push    esi
CODE:000000A2                 push    edi
CODE:000000A3                 mov     ebp, 101h
CODE:000000A8                 mov     esi, eax
CODE:000000AA                 push    ebp
CODE:000000AB                 xor     edi, edi
CODE:000000AD                 lea     ebx, [esi+1Ch]
CODE:000000B0                 push    edi
CODE:000000B1                 push    ebx
CODE:000000B2                 call    near ptr 0FFFFEEAAh
CODE:000000B7                 mov     [esi+4], edi
CODE:000000BA                 mov     [esi+8], edi
CODE:000000BD                 mov     [esi+0Ch], edi
CODE:000000C0                 xor     eax, eax
CODE:000000C2                 lea     edi, [esi+10h]
CODE:000000C5                 stosd
CODE:000000C6                 stosd
CODE:000000C7                 stosd
CODE:000000C8                 mov     eax, 411368h
CODE:000000CD                 add     esp, 0Ch
CODE:000000D0                 sub     eax, esi
CODE:000000D2
CODE:000000D2 loc_D2:                                 ; CODE XREF: CODE:000000D9↓j
CODE:000000D2                 mov     cl, [eax+ebx]
CODE:000000D5                 mov     [ebx], cl
CODE:000000D7                 inc     ebx
CODE:000000D8                 dec     ebp
CODE:000000D9                 jnz     short loc_D2
CODE:000000DB                 lea     ecx, [esi+11Dh]
CODE:000000E1                 mov     esi, 100h
CODE:000000E6
CODE:000000E6 loc_E6:                                 ; CODE XREF: CODE:000000ED↓j
CODE:000000E6                 mov     dl, [ecx+eax]
CODE:000000E9                 mov     [ecx], dl
CODE:000000EB                 inc     ecx
CODE:000000EC                 dec     esi
CODE:000000ED                 jnz     short loc_E6
CODE:000000EF                 pop     edi
CODE:000000F0                 pop     esi
CODE:000000F1                 pop     ebp
CODE:000000F2                 pop     ebx
CODE:000000F3                 retn
CODE:000000F4 ; ---------------------------------------------------------------------------
CODE:000000F4                 push    ebp
CODE:000000F5                 lea     ebp, [esp-49Ch]
CODE:000000FC                 sub     esp, 51Ch
CODE:00000102                 mov     eax, ds:4110D0h
CODE:00000107                 xor     eax, ebp
CODE:00000109                 mov     [ebp+498h], eax
CODE:0000010F                 push    ebx
CODE:00000110                 push    edi
CODE:00000111                 lea     eax, [ebp-7Ch]
CODE:00000114                 push    eax
CODE:00000115                 push    dword ptr [esi+4]
CODE:00000118                 call    dword ptr ds:40C0ACh
CODE:0000011E                 test    eax, eax
CODE:00000120                 mov     edi, 100h
CODE:00000125                 jz      loc_21A
CODE:0000012B                 xor     eax, eax
CODE:0000012D
CODE:0000012D loc_12D:                                ; CODE XREF: CODE:00000137↓j
CODE:0000012D                 mov     [ebp+eax+398h], al
CODE:00000134                 inc     eax
CODE:00000135                 cmp     eax, edi
CODE:00000137                 jb      short loc_12D
CODE:00000139                 mov     al, [ebp-76h]
CODE:0000013C                 test    al, al
CODE:0000013E                 mov     byte ptr [ebp+398h], 20h ; ' '
CODE:00000145                 jz      short loc_172
CODE:00000147                 lea     ebx, [ebp-75h]
CODE:0000014A
CODE:0000014A loc_14A:                                ; CODE XREF: CODE:00000170↓j
CODE:0000014A                 movzx   ecx, al
CODE:0000014D                 movzx   eax, byte ptr [ebx]
CODE:00000150                 cmp     ecx, eax
CODE:00000152                 ja      short loc_16A
CODE:00000154                 sub     eax, ecx
CODE:00000156                 inc     eax
CODE:00000157                 push    eax
CODE:00000158                 lea     edx, [ebp+ecx+398h]
CODE:0000015F                 push    20h ; ' '
CODE:00000161                 push    edx
CODE:00000162                 call    near ptr 0FFFFEEAAh
CODE:00000167                 add     esp, 0Ch
CODE:0000016A
CODE:0000016A loc_16A:                                ; CODE XREF: CODE:00000152↑j
CODE:0000016A                 inc     ebx
CODE:0000016B                 mov     al, [ebx]
CODE:0000016D                 inc     ebx
CODE:0000016E                 test    al, al
CODE:00000170                 jnz     short loc_14A
CODE:00000172
CODE:00000172 loc_172:                                ; CODE XREF: CODE:00000145↑j
CODE:00000172                 push    0
CODE:00000174                 push    dword ptr [esi+0Ch]
CODE:00000177                 lea     eax, [ebp-68h]
CODE:0000017A                 push    dword ptr [esi+4]
CODE:0000017D                 push    eax
CODE:0000017E                 push    edi
CODE:0000017F                 lea     eax, [ebp+398h]
CODE:00000185                 push    eax
CODE:00000186                 push    1
CODE:00000188                 push    0
CODE:0000018A                 call    near ptr 4315h
CODE:0000018F                 xor     ebx, ebx
CODE:00000191                 push    ebx
CODE:00000192                 push    dword ptr [esi+4]
CODE:00000195                 lea     eax, [ebp+298h]
CODE:0000019B                 push    edi
CODE:0000019C                 push    eax
CODE:0000019D                 push    edi
CODE:0000019E                 lea     eax, [ebp+398h]
CODE:000001A4                 push    eax
CODE:000001A5                 push    edi
CODE:000001A6                 push    dword ptr [esi+0Ch]
CODE:000001A9                 push    ebx
CODE:000001AA                 call    near ptr 12F5h
CODE:000001AF                 add     esp, 44h
CODE:000001B2                 push    ebx
CODE:000001B3                 push    dword ptr [esi+4]
CODE:000001B6                 lea     eax, [ebp+198h]
CODE:000001BC                 push    edi
CODE:000001BD                 push    eax
CODE:000001BE                 push    edi
CODE:000001BF                 lea     eax, [ebp+398h]
CODE:000001C5                 push    eax
CODE:000001C6                 push    200h
CODE:000001CB                 push    dword ptr [esi+0Ch]
CODE:000001CE                 push    ebx
CODE:000001CF                 call    near ptr 12F5h
CODE:000001D4                 add     esp, 24h
CODE:000001D7                 xor     eax, eax
CODE:000001D9
CODE:000001D9 loc_1D9:                                ; CODE XREF: CODE:00000216↓j
CODE:000001D9                 movzx   ecx, word ptr [ebp+eax*2-68h]
CODE:000001DE                 test    cl, 1
CODE:000001E1                 jz      short loc_1F1
CODE:000001E3                 or      byte ptr [esi+eax+1Dh], 10h
CODE:000001E8                 mov     cl, [ebp+eax+298h]
CODE:000001EF                 jmp     short loc_202
CODE:000001F1 ; ---------------------------------------------------------------------------
CODE:000001F1
CODE:000001F1 loc_1F1:                                ; CODE XREF: CODE:000001E1↑j
CODE:000001F1                 test    cl, 2
CODE:000001F4                 jz      short loc_20B
CODE:000001F6                 or      byte ptr [esi+eax+1Dh], 20h
CODE:000001FB                 mov     cl, [ebp+eax+198h]
CODE:00000202
CODE:00000202 loc_202:                                ; CODE XREF: CODE:000001EF↑j
CODE:00000202                 mov     [esi+eax+11Dh], cl
CODE:00000209                 jmp     short loc_213
CODE:0000020B ; ---------------------------------------------------------------------------
CODE:0000020B
CODE:0000020B loc_20B:                                ; CODE XREF: CODE:000001F4↑j
CODE:0000020B                 mov     byte ptr [esi+eax+11Dh], 0
CODE:00000213
CODE:00000213 loc_213:                                ; CODE XREF: CODE:00000209↑j
CODE:00000213                 inc     eax
CODE:00000214                 cmp     eax, edi
CODE:00000216                 jb      short loc_1D9
CODE:00000218                 jmp     short loc_267
CODE:0000021A ; ---------------------------------------------------------------------------
CODE:0000021A
CODE:0000021A loc_21A:                                ; CODE XREF: CODE:00000125↑j
CODE:0000021A                 lea     eax, [esi+11Dh]
CODE:00000220                 mov     dword ptr [ebp-80h], 0FFFFFF9Fh
CODE:00000227                 xor     ecx, ecx
CODE:00000229                 sub     [ebp-80h], eax
CODE:0000022C                 mov     edx, [ebp-80h]
CODE:0000022F                 lea     eax, [esi+ecx+11Dh]
CODE:00000236                 add     edx, eax
CODE:00000238                 lea     ebx, [edx+20h]
CODE:0000023B                 cmp     ebx, 19h
CODE:0000023E                 ja      short loc_24C
CODE:00000240                 or      byte ptr [esi+ecx+1Dh], 10h
CODE:00000245                 mov     dl, cl
CODE:00000247                 add     dl, 20h ; ' '
CODE:0000024A                 jmp     short loc_25B
CODE:0000024C ; ---------------------------------------------------------------------------
CODE:0000024C
CODE:0000024C loc_24C:                                ; CODE XREF: CODE:0000023E↑j
CODE:0000024C                 cmp     edx, 19h
CODE:0000024F                 ja      short loc_25F
CODE:00000251                 or      byte ptr [esi+ecx+1Dh], 20h
CODE:00000256                 mov     dl, cl
CODE:00000258                 sub     dl, 20h ; ' '
CODE:0000025B
CODE:0000025B loc_25B:                                ; CODE XREF: CODE:0000024A↑j
CODE:0000025B                 mov     [eax], dl
CODE:0000025D                 jmp     short loc_262
CODE:0000025F ; ---------------------------------------------------------------------------
CODE:0000025F
CODE:0000025F loc_25F:                                ; CODE XREF: CODE:0000024F↑j
CODE:0000025F                 mov     byte ptr [eax], 0
CODE:00000262
CODE:00000262 loc_262:                                ; CODE XREF: CODE:0000025D↑j
CODE:00000262                 inc     ecx
CODE:00000263                 cmp     ecx, edi
CODE:00000265
CODE:00000265 loc_265:                                ; CODE XREF: CODE:loc_61↑j
CODE:00000265                 jb      short near ptr 29Ah
CODE:00000267
CODE:00000267 loc_267:                                ; CODE XREF: CODE:00000218↑j
CODE:00000267                 fisttp  dword ptr [ebx+43000FDCh]
CODE:0000026D                 or      [ebx], dh
CODE:0000026F                 ror     byte ptr [ebx-3FF4F7BDh], 75h
CODE:00000276                 add     ebx, eax                    ; SECOND VM CHECK STARTS HERE
CODE:00000276 CODE            ends
CODE:00000276
CODE:00000276
CODE:00000276                 end
